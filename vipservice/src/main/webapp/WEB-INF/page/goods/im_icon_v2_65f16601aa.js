define("zenjs/class",["require","exports","module"],function(t,e,n){var i=!1,o=/\b_super\b/,r=function(){};r.extend=function(t){function e(){!i&&this.init&&this.init.apply(this,arguments)}var n=this.prototype;i=!0;var r=new this;i=!1;for(var s in t)r[s]="function"==typeof t[s]&&"function"==typeof n[s]&&o.test(t[s])?function(t,e){return function(){var i=this._super;this._super=n[t];var o=e.apply(this,arguments);return this._super=i,o}}(s,t[s]):t[s];return e.prototype=r,e.prototype.constructor=e,e.extend=arguments.callee,e},n.exports=r}),define("zenjs/core/trigger_method",[],function(){var t=function(){function t(t,e,n){return n.toUpperCase()}function e(t,e,n){return[].slice.call(t,null==e||n?1:e)}var n=/(^|:)(\w)/gi;return function(i){var o="on"+i.replace(n,t),r=this[o];return"function"==typeof this.trigger&&this.trigger.apply(this,arguments),"function"==typeof r?r.apply(this,e(arguments)):void 0}}();return t}),define("zenjs/events",["require","exports","module","./class","./core/trigger_method"],function(t,e,n){var i=t("./class"),o=t("./core/trigger_method");n.exports=i.extend({on:function(t,e,n){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push({callback:e,context:n,ctx:n||this}),this},off:function(t,e,n){var i,o,r,s,a,c,u,h;if(!t&&!e&&!n)return this._events={},this;for(s=t?[t]:Object.keys(this._events),a=0,c=s.length;c>a;a++)if(t=s[a],r=this._events[t]){if(this._events[t]=i=[],e||n)for(u=0,h=r.length;h>u;u++)o=r[u],(e&&e!==o.callback&&e!==o.callback._callback||n&&n!==o.context)&&i.push(o);i.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=[].slice.call(arguments,1),n=this._events[t];if(n)for(var i,o=-1;++o<n.length;)(i=n[o]).callback.apply(i.ctx,e)},triggerMethod:o})}),define("zenjs/util/number",[],function(){var t={makeRandomString:function(t){var e="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var i=0;t>i;i++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}};return t}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var e=function(){},n=t("zenjs/events"),i=t("zenjs/util/number");window.zenjs=window.zenjs||{};var o=n.extend({init:function(t){this._window=$(window);var n=i.makeRandomString();$("body").append('<div id="'+n+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".9")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+n),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var o=i.makeRandomString();$("body").append('<div id="'+o+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+o),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||e,this.onHide=t.onHide||e,this.onFinishHide=t.onFinishHide||e,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var e=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),e||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}});return o}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){window.zenjs=window.zenjs||{};var e=t("./pop"),n=e.extend({init:function(t){this._super(t),this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,e=function(n){return t!==this._window.scrollTop()&&n>0?(this._window.scrollTop(t),void setTimeout($.proxy(e,this,n-1))):void setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(e,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var e=$("body"),n=$("html");this.htmlPosition=n.css("position"),n.css("position","relative"),this.bodyCss=(e.prop("style")||{}).cssText,this.htmlCss=(n.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height()})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,e=t.indexOf(this);e>-1&&t.splice(e,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}});return n}),define("bower_components/pop/popup",["require","./pop_forbid_scroll"],function(t){var e=t("./pop_forbid_scroll"),n=e.extend({init:function(t){this._super(t),this.onClickBg=t.onClickBg||function(){},this.onBeforePopupShow=t.onBeforePopupShow||function(){},this.onAfterPopupHide=t.onAfterPopupHide||function(){},this.nPopContainer.css(_.extend({left:0,right:0,bottom:0,background:"white"},t.containerCss||{})),this.nPopContainer.css("opacity","0"),this.nPopContainer.on("focus","input, textarea",function(t){var e=$(this),n=$(window),i=n.scrollTop(),o=e.offset().top;(0>o-i||o-i>100)&&setTimeout(function(){var t=o-70;n.scrollTop(t)},150)})},_doShow:function(){this.contentView&&this.contentView.height?this.height=this.contentView.height():this.contentView||(this.height=this.nPopContainer.height()),this.onBeforePopupShow(),$(".js-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.addClass("popup"),this.nPopContainer.css({height:this.height+"px",transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)"}),this.bodyPadding=$("body").css("padding"),$("body").css("padding","0px"),setTimeout($.proxy(function(){this.nPopContainer.css({transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)","-webkit-transition":"all ease "+this.animationTime+"ms",transition:"all ease "+this.animationTime+"ms",opacity:1})},this)),setTimeout($.proxy(function(){this.contentView&&this.contentView.onAfterPopupShow&&this.contentView.onAfterPopupShow()},this),this.animationTime)},_doHide:function(t){this.nPopContainer.css({transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)",opacity:0}),setTimeout($.proxy(function(){$("body").css("padding",this.bodyPadding),this.onAfterPopupHide()},this),this.animationTime)}});return n}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(t){var e=t("./pop_forbid_scroll"),n=e.extend({init:function(t){t=t||{},this._super(t),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},t.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(t){this.nPopContainer.css({opacity:0})}});return n}),define("bower_components/pop/popout_box",["require","./popout"],function(t){var e=function(){},n=t("./popout"),i=n.extend({init:function(t){this._super(t),this._onOKClicked=t.onOKClicked||e,this._onCancelClicked=t.onCancelClicked||e,this.preventHideOnOkClicked=t.preventHideOnOkClicked||!1,this.width=t.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(t){this._super()},onOKClicked:function(t){this._onOKClicked(t),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(t){this._onCancelClicked(t),this.hide()}});return i}),define("bower_components/aes/aes",["require","exports","module"],function(t,e,n){var i=i||function(t,e){var n={},i=n.lib={},o=function(){},r=i.Base={extend:function(t){o.prototype=this;var e=new o;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=r.extend({init:function(t,n){t=this.words=t||[],this.sigBytes=n!=e?n:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var o=0;t>o;o++)e[i+o>>>2]|=(n[o>>>2]>>>24-8*(o%4)&255)<<24-8*((i+o)%4);else if(65535<n.length)for(o=0;t>o;o+=4)e[i+o>>>2]=n[o>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-8*(n%4),e.length=t.ceil(n/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],i=0;e>i;i+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),a=n.enc={},c=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;t>i;i++){var o=e[i>>>2]>>>24-8*(i%4)&255;n.push((o>>>4).toString(16)),n.push((15&o).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;e>i;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-4*(i%8);return new s.init(n,e/2)}},u=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;t>i;i++)n.push(String.fromCharCode(e[i>>>2]>>>24-8*(i%4)&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;e>i;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-8*(i%4);return new s.init(n,e)}},h=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},l=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,o=n.sigBytes,r=this.blockSize,a=o/(4*r),a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0);if(e=a*r,o=t.min(4*e,o),e){for(var c=0;e>c;c+=r)this._doProcessBlock(i,c);c=i.splice(0,e),n.sigBytes-=o}return new s.init(c,o)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=l.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new d.HMAC.init(t,n).finalize(e)}}});var d=n.algo={};return n}(Math);!function(){var t=i,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp(),t=[];for(var o=0;n>o;o+=3)for(var r=(e[o>>>2]>>>24-8*(o%4)&255)<<16|(e[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|e[o+2>>>2]>>>24-8*((o+2)%4)&255,s=0;4>s&&n>o+.75*s;s++)t.push(i.charAt(r>>>6*(3-s)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,i=this._map,o=i.charAt(64);o&&(o=t.indexOf(o),-1!=o&&(n=o));for(var o=[],r=0,s=0;n>s;s++)if(s%4){var a=i.indexOf(t.charAt(s-1))<<2*(s%4),c=i.indexOf(t.charAt(s))>>>6-2*(s%4);o[r>>>2]|=(a|c)<<24-8*(r%4),r++}return e.create(o,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,n,i,o,r,s){return t=t+(e&n|~e&i)+o+s,(t<<r|t>>>32-r)+e}function n(t,e,n,i,o,r,s){return t=t+(e&i|n&~i)+o+s,(t<<r|t>>>32-r)+e}function o(t,e,n,i,o,r,s){return t=t+(e^n^i)+o+s,(t<<r|t>>>32-r)+e}function r(t,e,n,i,o,r,s){return t=t+(n^(e|~i))+o+s,(t<<r|t>>>32-r)+e}for(var s=i,a=s.lib,c=a.WordArray,u=a.Hasher,a=s.algo,h=[],l=0;64>l;l++)h[l]=4294967296*t.abs(t.sin(l+1))|0;a=a.MD5=u.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,i){for(var s=0;16>s;s++){var a=i+s,c=t[a];t[a]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var s=this._hash.words,a=t[i+0],c=t[i+1],u=t[i+2],l=t[i+3],d=t[i+4],p=t[i+5],f=t[i+6],m=t[i+7],g=t[i+8],v=t[i+9],w=t[i+10],y=t[i+11],b=t[i+12],_=t[i+13],x=t[i+14],C=t[i+15],k=s[0],F=s[1],j=s[2],z=s[3],k=e(k,F,j,z,a,7,h[0]),z=e(z,k,F,j,c,12,h[1]),j=e(j,z,k,F,u,17,h[2]),F=e(F,j,z,k,l,22,h[3]),k=e(k,F,j,z,d,7,h[4]),z=e(z,k,F,j,p,12,h[5]),j=e(j,z,k,F,f,17,h[6]),F=e(F,j,z,k,m,22,h[7]),k=e(k,F,j,z,g,7,h[8]),z=e(z,k,F,j,v,12,h[9]),j=e(j,z,k,F,w,17,h[10]),F=e(F,j,z,k,y,22,h[11]),k=e(k,F,j,z,b,7,h[12]),z=e(z,k,F,j,_,12,h[13]),j=e(j,z,k,F,x,17,h[14]),F=e(F,j,z,k,C,22,h[15]),k=n(k,F,j,z,c,5,h[16]),z=n(z,k,F,j,f,9,h[17]),j=n(j,z,k,F,y,14,h[18]),F=n(F,j,z,k,a,20,h[19]),k=n(k,F,j,z,p,5,h[20]),z=n(z,k,F,j,w,9,h[21]),j=n(j,z,k,F,C,14,h[22]),F=n(F,j,z,k,d,20,h[23]),k=n(k,F,j,z,v,5,h[24]),z=n(z,k,F,j,x,9,h[25]),j=n(j,z,k,F,l,14,h[26]),F=n(F,j,z,k,g,20,h[27]),k=n(k,F,j,z,_,5,h[28]),z=n(z,k,F,j,u,9,h[29]),j=n(j,z,k,F,m,14,h[30]),F=n(F,j,z,k,b,20,h[31]),k=o(k,F,j,z,p,4,h[32]),z=o(z,k,F,j,g,11,h[33]),j=o(j,z,k,F,y,16,h[34]),F=o(F,j,z,k,x,23,h[35]),k=o(k,F,j,z,c,4,h[36]),z=o(z,k,F,j,d,11,h[37]),j=o(j,z,k,F,m,16,h[38]),F=o(F,j,z,k,w,23,h[39]),k=o(k,F,j,z,_,4,h[40]),z=o(z,k,F,j,a,11,h[41]),j=o(j,z,k,F,l,16,h[42]),F=o(F,j,z,k,f,23,h[43]),k=o(k,F,j,z,v,4,h[44]),z=o(z,k,F,j,b,11,h[45]),j=o(j,z,k,F,C,16,h[46]),F=o(F,j,z,k,u,23,h[47]),k=r(k,F,j,z,a,6,h[48]),z=r(z,k,F,j,m,10,h[49]),j=r(j,z,k,F,x,15,h[50]),F=r(F,j,z,k,p,21,h[51]),k=r(k,F,j,z,b,6,h[52]),z=r(z,k,F,j,l,10,h[53]),j=r(j,z,k,F,w,15,h[54]),F=r(F,j,z,k,c,21,h[55]),k=r(k,F,j,z,g,6,h[56]),z=r(z,k,F,j,C,10,h[57]),j=r(j,z,k,F,f,15,h[58]),F=r(F,j,z,k,_,21,h[59]),k=r(k,F,j,z,d,6,h[60]),z=r(z,k,F,j,y,10,h[61]),j=r(j,z,k,F,u,15,h[62]),F=r(F,j,z,k,v,21,h[63]);s[0]=s[0]+k|0,s[1]=s[1]+F|0,s[2]=s[2]+j|0,s[3]=s[3]+z|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,o=8*e.sigBytes;n[o>>>5]|=128<<24-o%32;var r=t.floor(i/4294967296);for(n[(o+64>>>9<<4)+15]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),n[(o+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(n.length+1),this._process(),e=this._hash,n=e.words,i=0;4>i;i++)o=n[i],n[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return e},clone:function(){var t=u.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=u._createHelper(a),s.HmacMD5=u._createHmacHelper(a)}(Math),function(){var t=i,e=t.lib,n=e.Base,o=e.WordArray,e=t.algo,r=e.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var n=this.cfg,i=n.hasher.create(),r=o.create(),s=r.words,a=n.keySize,n=n.iterations;s.length<a;){c&&i.update(c);var c=i.update(t).finalize(e);i.reset();for(var u=1;n>u;u++)c=i.finalize(c),i.reset();r.concat(c)}return r.sigBytes=4*a,r}});t.EvpKDF=function(t,e,n){return r.create(n).compute(t,e)}}(),i.lib.Cipher||function(t){var e=i,n=e.lib,o=n.Base,r=n.WordArray,s=n.BufferedBlockAlgorithm,a=e.enc.Base64,c=e.algo.EvpKDF,u=n.Cipher=s.extend({cfg:o.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,n,i){return("string"==typeof n?m:f).encrypt(t,e,n,i)},decrypt:function(e,n,i){return("string"==typeof n?m:f).decrypt(t,e,n,i)}}}});n.StreamCipher=u.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=e.mode={},l=function(e,n,i){var o=this._iv;o?this._iv=t:o=this._prevBlock;for(var r=0;i>r;r++)e[n+r]^=o[r]},d=(n.BlockCipherMode=o.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();d.Encryptor=d.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize;l.call(this,t,e,i),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+i)}}),d.Decryptor=d.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize,o=t.slice(e,e+i);n.decryptBlock(t,e),l.call(this,t,e,i),this._prevBlock=o}}),h=h.CBC=d,d=(e.pad={}).Pkcs7={pad:function(t,e){for(var n=4*e,n=n-t.sigBytes%n,i=n<<24|n<<16|n<<8|n,o=[],s=0;n>s;s+=4)o.push(i);n=r.create(o,n),t.concat(n)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},n.BlockCipher=u.extend({cfg:u.cfg.extend({mode:h,padding:d}),reset:function(){u.reset.call(this);var t=this.cfg,e=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=t.createEncryptor;else n=t.createDecryptor,this._minBufferSize=1;this._mode=n.call(t,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var p=n.CipherParams=o.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),h=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return t=t.salt,(t?r.create([1398893684,1701076831]).concat(t).concat(e):e).toString(a)},parse:function(t){t=a.parse(t);var e=t.words;if(1398893684==e[0]&&1701076831==e[1]){var n=r.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return p.create({ciphertext:t,salt:n})}},f=n.SerializableCipher=o.extend({cfg:o.extend({format:h}),encrypt:function(t,e,n,i){i=this.cfg.extend(i);var o=t.createEncryptor(n,i);return e=o.finalize(e),o=o.cfg,p.create({ciphertext:e,key:n,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(n,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),e=(e.kdf={}).OpenSSL={execute:function(t,e,n,i){return i||(i=r.random(8)),t=c.create({keySize:e+n}).compute(t,i),n=r.create(t.words.slice(e),4*n),t.sigBytes=4*e,p.create({key:t,iv:n,salt:i})}},m=n.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:e}),encrypt:function(t,e,n,i){return i=this.cfg.extend(i),n=i.kdf.execute(n,t.keySize,t.ivSize),i.iv=n.iv,t=f.encrypt.call(this,t,e,n.key,i),t.mixIn(n),t},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),n=i.kdf.execute(n,t.keySize,t.ivSize,e.salt),i.iv=n.iv,f.decrypt.call(this,t,e,n.key,i)}})}(),function(){for(var t=i,e=t.lib.BlockCipher,n=t.algo,o=[],r=[],s=[],a=[],c=[],u=[],h=[],l=[],d=[],p=[],f=[],m=0;256>m;m++)f[m]=128>m?m<<1:m<<1^283;for(var g=0,v=0,m=0;256>m;m++){var w=v^v<<1^v<<2^v<<3^v<<4,w=w>>>8^255&w^99;o[g]=w,r[w]=g;var y=f[g],b=f[y],_=f[b],x=257*f[w]^16843008*w;s[g]=x<<24|x>>>8,a[g]=x<<16|x>>>16,c[g]=x<<8|x>>>24,u[g]=x,x=16843009*_^65537*b^257*y^16843008*g,h[w]=x<<24|x>>>8,l[w]=x<<16|x>>>16,d[w]=x<<8|x>>>24,p[w]=x,g?(g=y^f[f[f[_^y]]],v^=f[f[v]]):g=v=1}var C=[0,1,2,4,8,16,32,64,128,27,54],n=n.AES=e.extend({_doReset:function(){for(var t=this._key,e=t.words,n=t.sigBytes/4,t=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],r=0;t>r;r++)if(n>r)i[r]=e[r];else{var s=i[r-1];r%n?n>6&&4==r%n&&(s=o[s>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s]):(s=s<<8|s>>>24,s=o[s>>>24]<<24|o[s>>>16&255]<<16|o[s>>>8&255]<<8|o[255&s],s^=C[r/n|0]<<24),i[r]=i[r-n]^s}for(e=this._invKeySchedule=[],n=0;t>n;n++)r=t-n,s=n%4?i[r]:i[r-4],e[n]=4>n||4>=r?s:h[o[s>>>24]]^l[o[s>>>16&255]]^d[o[s>>>8&255]]^p[o[255&s]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,a,c,u,o)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,h,l,d,p,r),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,i,o,r,s,a){for(var c=this._nRounds,u=t[e]^n[0],h=t[e+1]^n[1],l=t[e+2]^n[2],d=t[e+3]^n[3],p=4,f=1;c>f;f++)var m=i[u>>>24]^o[h>>>16&255]^r[l>>>8&255]^s[255&d]^n[p++],g=i[h>>>24]^o[l>>>16&255]^r[d>>>8&255]^s[255&u]^n[p++],v=i[l>>>24]^o[d>>>16&255]^r[u>>>8&255]^s[255&h]^n[p++],d=i[d>>>24]^o[u>>>16&255]^r[h>>>8&255]^s[255&l]^n[p++],u=m,h=g,l=v;m=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[l>>>8&255]<<8|a[255&d])^n[p++],g=(a[h>>>24]<<24|a[l>>>16&255]<<16|a[d>>>8&255]<<8|a[255&u])^n[p++],v=(a[l>>>24]<<24|a[d>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^n[p++],d=(a[d>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&l])^n[p++],t[e]=m,t[e+1]=g,t[e+2]=v,t[e+3]=d},keySize:8});t.AES=e._createHelper(n)}(),i.pad.Iso10126={pad:function(t,e){var n=4*e,n=n-t.sigBytes%n;t.concat(i.lib.WordArray.random(n-1)).concat(i.lib.WordArray.create([n<<24],1))},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},n.exports=i}),define("bower_components/aes/main",["require","./aes"],function(t){var e=t("./aes"),n=e.enc.Utf8.parse("youzan.com.aesiv"),i=e.enc.Utf8.parse("youzan.com._key_");return{encrypt:function(t){return t=e.enc.Utf8.parse(t),e.AES.encrypt(t,i,{mode:e.mode.CBC,padding:e.pad.Iso10126,iv:n}).toString()}}}),define("text!bower_components/login/templates/init.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>请填写您的手机号码</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="" value="<%= phone %>">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <input type="submit" class="js-confirm btn btn-green btn-block font-size-14" value="确认手机号码" />\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/login.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>该号码注册过，请直接登录</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" placeholder="请输入登录密码">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">\n            <%= showBindText ? \'登录并绑定\' : \'确认\' %>\n        </button>\n    </div>\n    <div class="bottom-tips font-size-12">\n        <span class="c-orange">如果您忘了密码，请</span><a href="javascript:;" class="js-change-pwd c-blue">点此找回密码</a>\n        <a href="javascript:;" class="js-change-phone c-blue pull-right">更换手机号</a>\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/register.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>注册有赞帐号</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item js-image-verify hide">\n            <label for="verifycode">身份校验</label>\n            <input id="verifycode" name="verifycode" class="js-verify-code item-input"  type="tel" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入右侧数字">\n            <img class="js-verify-image verify-image" src="">\n        </div>\n        <div class="form-item">\n            <label for="code">验证码</label>\n            <input id="code" name="code"  type="text" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入短信验证码">\n            <button type="button" class="js-auth-code tag btn-auth-code tag-green font-size-12" data-text="获取验证码">\n                获取验证码\n            </button>\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" maxlength="20" placeholder="请输入8-20位数字和字母组合">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">\n            <%= showBindText ? \'注册并绑定\' : \'确认\' %>\n        </button>\n    </div>\n    <div class="bottom-tips font-size-12">\n        <span class="c-orange">如果您忘了密码，请</span><a href="javascript:;" class="js-change-pwd c-blue">点此找回密码</a>\n        <a href="javascript:;" class="js-change-phone c-blue pull-right">更换手机号</a>\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/change_pwd.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2><%if(isSetting){%>设定<%}else{%>找回<%}%>帐号密码</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item js-image-verify hide">\n            <label for="verifycode">身份校验</label>\n            <input id="verifycode" name="verifycode" class="js-verify-code item-input"  type="tel" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入右侧数字">\n            <img class="js-verify-image verify-image" src="">\n        </div>\n        <div class="form-item">\n            <label for="code">验证码</label>\n            <input id="code" name="code"  type="text" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入短信验证码">\n            <button type="button" class="js-auth-code tag btn-auth-code font-size-12 tag-green" data-text="获取验证码">\n                获取验证码\n            </button>\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" placeholder="设置新的8-20位数字和字母组合密码">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">确定</button>\n    </div>\n    <div class="bottom-tips pull-right">\n        <a href="javascript:;" class="js-login inline-item c-blue">已有帐号登录</a>\n        <a href="javascript:;" class="js-register inline-item c-blue">注册新帐号</a>\n    </div>\n</form>\n'}),define("zenjs/util/valid",[],function(){window.zenjs=window.zenjs||{};var t={validMobile:function(t){return t=""+t,/^((\+86)|(86))?(1)\d{10}$/.test(t)},validPhone:function(t){return t=""+t,/^0[0-9\-]{10,13}$/.test(t)},validNumber:function(t){return/^\d+$/.test(t)},validEmail:function(t){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},validPostalCode:function(t){return t=""+t,/^\d{6}$/.test(t)}};return window.zenjs.Valid=t,t}),window.Zepto&&function(t){t.fn.serializeArray=function(){var e,n,i=[],o=function(t){return t.forEach?t.forEach(o):void i.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(i,r){n=r.type,e=r.name,e&&"fieldset"!=r.nodeName.toLowerCase()&&!r.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&"file"!=n&&("radio"!=n&&"checkbox"!=n||r.checked)&&o(t(r).val())}),i},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),define("vendor/zepto/form",function(){}),define("zenjs/util/form",["require","exports","module","vendor/zepto/form","jquery"],function(t,e,n){t("vendor/zepto/form");var i=t("jquery");window.zenjs=window.zenjs||{};var o={getFormData:function(t){var e=t.serializeArray(),n={};return i.map(e,function(t){n[t.name]=t.value}),n}};window.zenjs.Form=o,n.exports=o}),define("zenjs/sms_fetch/main",["require","exports","module","bower_components/ajax/ajax","jquery"],function(t,e,n){function i(){this.loadingLock=!1,this.isUsed=void 0}function o(t){t=t||{},this.$el=r(t.el||t.$el||"<div></div>"),this.el=this.$el[0],this.$=function(t){return this.$el.find(t)},this.initialize&&this.initialize(t)}t("bower_components/ajax/ajax");var r=t("jquery"),s=function(){};i.prototype={fetch:function(){if(this.isUsed!==!1){var t=this;this.loadingLock=!0,r._ajax({url:window._global.url.www.replace(/^https?:\/\//,"//")+"/common/token/token.jsonp",
type:"get",dataType:"jsonp"}).done(function(e){0==e.code?(t.token=e.data,t.loadingLock=!1,t.isUsed=!1):motify.log(e.msg)}).fail(function(){motify.log("token 获取失败")})}},get:function(){return this.isUsed=!0,this.token}};var a=new i;r.extend(o.prototype,{initialize:function(t){this.duration=t.time||60,this.step=t.step||1100,this.codeVerifyClass=t.codeVerifyClass||"js-verify-code",this.verifyType="smsFetch";var e=window._global.url.www.replace(/^https?:\/\//,"//");this.smsFetchUrl=e+"/common/sms/captcha.jsonp",this.imgUrl=e+"/common/sms/imgcaptcha",this.imgVerifyUrl=e+"/common/sms/imgcaptcha.jsonp",this.biz=t.biz||"kdt_account_captcha",this.onTimeChange=t.onTimeChange||s,this.onTimeEnd=t.onTimeEnd||s,this.onTimerStart=t.onTimerStart||s,this.onTimerClose=t.onTimerClose||s,this.onVerifyPictureShow=t.onVerifyPictureShow||s,this.onGetCodeError=t.onGetCodeError||s,this.onVerifyPictureSuccess=t.onVerifyPictureSuccess||s,this.onVerifyPictureError=t.onVerifyPictureError||s,this.platform=t.platform||"",this.subFrom=t.subFrom||"",a.fetch()},setMobile:function(t){t&&(this.mobile=t)},getImageCode:function(){return r.trim(this.$("."+this.codeVerifyClass).val())},getSms:function(t){var e=this;if(a.loadingLock)return void motify.log("数据加载中，稍后再试");if(t=t||{},t.mobile&&(this.mobile=t.mobile),!this.mobile)return!1;var n={smsFetch:e.onSmsFetchHandler,image:e.onImageHandler};return e.startTimer.call(e),(n[e.verifyType]||s).call(e),this},startTimer:function(){this.onTimerStart(),this.btnCountdown(this.duration)},stopTimer:function(){clearTimeout(this.timer),this.onTimerClose()},btnCountdown:function(t){var e=this;this.onTimeChange({second:t}),--t>=0?this.timer=setTimeout(function(){e.btnCountdown(t)},this.step):(this.onTimeEnd(),this.timer="")},onVerifyImageShow:function(t){this.$(".js-image-verify").removeClass("hide"),this.$(".js-verify-image").attr("src",t)},onVerifyImageHide:function(){this.$(".js-image-verify").addClass("hide")},onSmsFetchHandler:function(){var t=1;return function(){var e=this,n={verifyTimes:t,mobile:this.mobile,biz:this.biz,token:a.get()};this.platform&&(n.platform=this.platform),this.subFrom&&(n.sub_from=this.subFrom),r._ajax({url:this.smsFetchUrl,dataType:"jsonp",data:n,success:function(n){return 0==n.code?void t++:(e.stopTimer.call(e),e.onGetCodeError.call(e),void(10111===n.code?(e.verifyType="image",e.onVerifyImageShow(e.imgUrl),e.onVerifyPictureShow()):(t++,motify.log(n.msg))))},error:function(n,i,o){t++,e.stopTimer.call(e),e.onGetCodeError.call(e),motify.log("获取验证码失败，请稍后再试")},complete:function(t,e){}}).always(function(){a.fetch()})}}(),onImageHandler:function(){var t=this,e=this.mobile;r._ajax({url:this.imgVerifyUrl,dataType:"jsonp",data:{mobile:e,captcha_code:this.getImageCode()},success:function(n){return 0===n.code?(t.verifyType="smsFetch",t.mobile=e,t.onVerifyImageHide(),t.onVerifyPictureSuccess(),void t.onSmsFetchHandler()):(t.stopTimer.call(t),t.onVerifyPictureError.call(t),void(10100===n.code?(motify.log(n.msg),t.$el.find(".js-verify-image").attr("src",t.imgUrl)):motify.log(n.msg)))},error:function(e,n,i){t.stopTimer.call(t),t.onVerifyPictureError.call(t),motify.log("图形验证失败，重试一下吧~"),t.$el.find(".js-verify-image").attr("src",t.imgUrl)},complete:function(t,e){}})}}),n.exports=o}),define("zenjs/util/url_helper",[],function(){var t={site:function(t,e){var n=window._global.env,i=window._global.url;"static"===e&&"online"===n&&(e="cdn_static");var o=t;return e=e?i[e]||"":"",-1==t.search(/^http[s]?\:\/\//)&&("/"!==t[0]&&(t="/"+t),o=e+t),o},getCdnImageUrl:function(t,e){if(!t)return window._global.url.cdn_static+"/image/wap/no_pic.png";if(e=t.match(/.+\!\d+x\d+.+/)?"":e&&e.length>0?e:"!100x100.jpg",t.match(/^(https?:)?\/\//i)){for(var n=[/^(https?:)?\/\/imgqn.koudaitong.com/,/^(https?:)?\/\/kdt-img.koudaitong.com/,/^(https?:)?\/\/img.yzcdn.cn/,/^(https?:)?\/\/dn-kdt-img.qbox.me/],i=0;i<n.length;i++)t=t.replace(n[i],window._global.url.imgqn);return t+e}return window._global.url.imgqn+"/"+t+e}};return t}),define("zenjs/util/ua",[],function(){var t=navigator.userAgent.toLowerCase(),e={isIOS:function(){return"ios"==window._global.mobile_system},getIOSVersion:function(){return parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||!1},isAndroid:function(){return"android"==window._global.mobile_system},isAndroidOld:function(){return/android 2.3/gi.test(t)||/android 2.2/gi.test(t)},getAndroidVersion:function(){var e=t.match(/android\s([0-9\.]*)/);return e?e[1]:!1},isWeixin:function(){return"weixin"==window._global.platform},isQQ:function(){return"qq"==window._global.platform},isIPad:function(){return/ipad/gi.test(t)},isMobile:function(){return window._global.is_mobile},isSafari:function(){return/safari/gi.test(t)&&!/chrome/gi.test(t)},getSafariVersion:function(){var e=/safari\/(\S*)/i;return e.test(t)?t.match(e)[1]:"0"},isChrome:function(){return/chrome/gi.test(t)},getChromeVersion:function(){var e=/chrome\/(\S*)/i;return e.test(t)?t.match(e)[1]:"0"},isUC:function(){return/ucbrowser/gi.test(t)},getUCVersion:function(){var e=/ucbrowser\/(\S*)/i;return e.test(t)?t.match(e)[1]:"0"},isWxd:function(){return"youzanwxd"===_global.platform},isWsc:function(){return"youzanwsc"===_global.platform},isPf:function(){return"younipf"===_global.platform},getPlatformVersion:function(){return _global.platform_version},getPlatform:function(){return _global.platform}};return e}),define("bower_components/login/main",["require","bower_components/ajax/ajax","jquery","backbone","bower_components/aes/main","text!./templates/init.html","text!./templates/login.html","text!./templates/register.html","text!./templates/change_pwd.html","zenjs/util/valid","zenjs/util/form","zenjs/sms_fetch/main","zenjs/util/url_helper","zenjs/util/ua"],function(t){t("bower_components/ajax/ajax");var e=t("jquery"),n=t("backbone"),i=t("bower_components/aes/main"),o=t("text!./templates/init.html"),r=t("text!./templates/login.html"),s=t("text!./templates/register.html"),a=t("text!./templates/change_pwd.html"),c=t("zenjs/util/valid"),u=t("zenjs/util/form"),h=t("zenjs/sms_fetch/main"),l=t("zenjs/util/url_helper"),d=t("zenjs/util/ua"),p=["youzanmars"],f=n.View.extend({events:{"click .js-confirm":"onConfirmClicked","click .js-change-phone":"onChangePhoneClicked","click .js-change-pwd":"onChangePwdClicked","click .js-login":"onLoginClicked","click .js-register":"onRegisterClicked","click .js-auth-code":"onAuthcodeClicked","submit .js-login-form":"onConfirmClicked"},initialize:function(t){t=t||{};var n=d.getPlatform();if(p.indexOf(n)>-1)return void(window.location.href=l.site("/buyer/kdtunion?redirect_uri="+encodeURIComponent(window.location.href),"wap"));var i=this,c=_global.url;this.tpl_map={init:_.template(t.initTpl||o),login:_.template(t.loginTpl||r),register:_.template(t.registerTpl||s),changePwd:_.template(t.changePwdTpl||a)},this.valid_map={checkPhone:_(this.checkPhone).bind(this),checkPwd:_(this.checkPwd).bind(this),checkCode:_(this.checkCode).bind(this)},this.renderOpt=t.renderOpt||{type:"init",phone:""},this.renderOpt.showBindText=d.isWeixin()||d.isQQ(),this.urlMap={login:t.loginUrl||c.uic+"/buyer/auth/authlogin.json",register:t.registerUrl||c.uic+"/buyer/auth/authRegister.json",changePwd:t.changePwdUrl||c.uic+"/buyer/auth/changePassword.json",confirm:t.confirmUrl||c.uic+"/buyer/auth/authConfirm.json"},this.source=t.source||2,this.ajaxType=t.ajaxType||"POST",this.afterLogin=t.afterLogin||function(){};var u,f;d.isMobile()?(u="app",f="wsc",d.isWxd()?f="wxd":d.isWsc()?f="wsc":d.isPf()?f="pf":u="wap"):u="pc",this.sms=new h({el:this.$el,onTimeChange:function(t){var n=t.second;e(i.nAuthCode).text("等待 "+n+"秒")},onTimeEnd:function(){i.nAuthCode.text("再次获取"),i.nAuthCode.prop("disabled",!1),i.nAuthCode.removeClass("disabled"),i.nCodeInput.attr("placeholder","没有收到验证码？")},onTimerStart:function(){i.nAuthCode.prop("disabled",!0),i.nAuthCode.addClass("disabled")},onVerifyPictureError:function(){i.nAuthCode.removeAttr("disabled"),i.nAuthCode.removeClass("disabled"),i.nAuthCode.text("再次获取")},onGetCodeError:function(){i.nAuthCode.removeAttr("disabled"),i.nAuthCode.removeClass("disabled"),i.nAuthCode.text("再次获取")},onVerifyPictureShow:function(){i.nHelpInfo.html("操作过于频繁，请先输入图像验证码再获取")},onVerifyPictureSuccess:function(){i.nHelpInfo.html("")},platform:u,subFrom:f})},render:function(){return this.appLogined?this:(this.$el.html(this.tpl_map[this.renderOpt.type](this.renderOpt)),this.nForm=this.$(".js-login-form"),this.nHelpInfo=this.$(".js-help-info"),this.nPhone=this.$('input[name="phone"]'),this.nPwd=this.$('input[name="password"]'),this.nCodeInput=this.$('input[name="authcode"]'),this.nAuthCode=this.$(".js-auth-code"),this)},show:function(t,e){"changePwd"==t?this.sms.biz="reset_account_passwd":this.sms.biz="kdt_account_captcha",_.extend(this.renderOpt,{type:t},e||{isSetting:!1}),this.render(this.renderOpt),this.$el.show(this.animationTime)},onConfirmClicked:function(t){t.preventDefault();var n=this,o=e(t.target),r=u.getFormData(n.nForm);if(r=_.extend(n.renderOpt,r),!n.validate(r))return!1;r.source=this.source,r.password&&(r.password=i.encrypt(r.password));var s=o.html();if("init"===n.renderOpt.type)n.renderOpt.phone=r.phone,e._ajax({url:this.urlMap.confirm,type:"POST",dataType:"json",timeout:15e3,data:r,xhrFields:{withCredentials:!0},beforeSend:function(){o.html("确认中..."),o.prop("disabled",!0)},success:function(t){switch(+t.code){case 0:n.show("login");break;case 135000003:n.show("register");break;default:n.nHelpInfo.html(t.msg)}},error:function(){n.nHelpInfo.html("出错啦，请重试")},complete:function(){o.html(s),o.prop("disabled",!1)}});else{var a=n.renderOpt.type;e._ajax({url:this.urlMap[a],type:this.ajaxType,dataType:"json",timeout:15e3,data:r,xhrFields:{withCredentials:!0},beforeSend:function(){o.html("确认中..."),o.prop("disabled",!0)},success:function(t){0===t.code?n.afterLogin(t,{type:a}):n.nHelpInfo.html(t.msg)},error:function(){n.nHelpInfo.html("出错啦，请重试")},complete:function(){o.html(s),o.prop("disabled",!1)}})}},onAuthcodeClicked:function(t){t.preventDefault();var e=this,n=u.getFormData(e.nForm);n=_.extend(e.renderOpt,n);var i=n.phone;this.sms.setMobile(i),this.sms.getSms()},onChangePhoneClicked:function(t){t.preventDefault(),this.show("init")},onChangePwdClicked:function(t){t.preventDefault(),this.sms.stopTimer(),this.show("changePwd")},onLoginClicked:function(t){t.preventDefault(),this.show("init")},onRegisterClicked:function(t){t.preventDefault(),this.show("init")},validate:function(){var t={init:["checkPhone"],login:["checkPwd"],register:["checkCode","checkPwd"],changePwd:["checkCode","checkPwd"]};return function(e){return _.every(t[e.type],_(function(t){return this.valid_map[t](e)}).bind(this))}}(),checkPhone:function(t){return""===t.phone?(this.nPhone.focus(),this.nHelpInfo.html("请填写您的手机号码"),!1):c.validMobile(t.phone)?!0:(this.nPhone.focus(),this.nHelpInfo.html("请填写11位手机号码"),!1)},checkPwd:function(t){function e(t){var e=/[a-zA-Z]/g,n=/[0-9]/g,i=0,o=e.test(t),r=n.test(t);return o&&r&&(i=1),i}if(""===t.password)return this.nPwd.focus(),this.nHelpInfo.html("请输入您的密码"),!1;if("login"!==this.renderOpt.type&&t.password.length<8)return this.nPwd.focus(),this.nHelpInfo.html("亲，密码最短为8位"),!1;if("login"!==this.renderOpt.type&&t.password.length>20)return this.nPwd.focus(),this.nHelpInfo.html("亲，密码最长为20位"),!1;if("login"!==this.renderOpt.type){var n=e(t.password);if(!n)return this.nPwd.focus(),this.nHelpInfo.html("亲，密码为8-20位数字和字母组合"),!1}return!0},checkCode:function(t){return c.validPostalCode(t.code)?!0:(this.nCodeInput.focus(),this.nHelpInfo.html("请填写6位短信验证码"),!1)}});return f}),function(){Date.shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Date.longMonths=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.shortDays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Date.longDays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var t={d:function(){return(this.getDate()<10?"0":"")+this.getDate()},D:function(){return Date.shortDays[this.getDay()]},j:function(){return this.getDate()},l:function(){return Date.longDays[this.getDay()]},N:function(){return 0===this.getDay()?7:this.getDay()},S:function(){return this.getDate()%10==1&&11!=this.getDate()?"st":this.getDate()%10==2&&12!=this.getDate()?"nd":this.getDate()%10==3&&13!=this.getDate()?"rd":"th"},w:function(){return this.getDay()},z:function(){var t=new Date(this.getFullYear(),0,1);return Math.ceil((this-t)/864e5)},W:function(){var t=new Date(this.valueOf()),e=(this.getDay()+6)%7;t.setDate(t.getDate()-e+3);var n=t.valueOf();return t.setMonth(0,1),4!==t.getDay()&&t.setMonth(0,1+(4-t.getDay()+7)%7),1+Math.ceil((n-t)/6048e5)},F:function(){return Date.longMonths[this.getMonth()]},m:function(){return(this.getMonth()<9?"0":"")+(this.getMonth()+1)},M:function(){return Date.shortMonths[this.getMonth()]},n:function(){return this.getMonth()+1},t:function(){var t=this.getFullYear(),e=this.getMonth()+1;return 12===e&&(t=t++,e=0),new Date(t,e,0).getDate()},L:function(){var t=this.getFullYear();return t%400===0||t%100!==0&&t%4===0},o:function(){var t=new Date(this.valueOf());return t.setDate(t.getDate()-(this.getDay()+6)%7+3),t.getFullYear()},Y:function(){return this.getFullYear()},y:function(){return(""+this.getFullYear()).substr(2)},a:function(){return this.getHours()<12?"am":"pm"},A:function(){return this.getHours()<12?"AM":"PM"},B:function(){return Math.floor(1e3*((this.getUTCHours()+1)%24+this.getUTCMinutes()/60+this.getUTCSeconds()/3600)/24)},g:function(){return this.getHours()%12||12},G:function(){return this.getHours()},h:function(){return((this.getHours()%12||12)<10?"0":"")+(this.getHours()%12||12)},H:function(){return(this.getHours()<10?"0":"")+this.getHours()},i:function(){return(this.getMinutes()<10?"0":"")+this.getMinutes()},s:function(){return(this.getSeconds()<10?"0":"")+this.getSeconds()},u:function(){var t=this.getMilliseconds();return(10>t?"00":100>t?"0":"")+t},e:function(){return/\((.*)\)/.exec((new Date).toString())[1]},I:function(){for(var t=null,e=0;12>e;++e){var n=new Date(this.getFullYear(),e,1),i=n.getTimezoneOffset();if(null===t)t=i;else{if(t>i){t=i;break}if(i>t)break}}return this.getTimezoneOffset()==t|0},O:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+"00"},P:function(){return(-this.getTimezoneOffset()<0?"-":"+")+(Math.abs(this.getTimezoneOffset()/60)<10?"0":"")+Math.abs(this.getTimezoneOffset()/60)+":00"},T:function(){return this.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1")},Z:function(){return 60*-this.getTimezoneOffset()},c:function(){return this.format("Y-m-d\\TH:i:sP")},r:function(){return this.toString()},U:function(){return this.getTime()/1e3}};Date.prototype.format=function(e){var n=this;return e.replace(/(\\?)(.)/g,function(e,i,o){return""===i&&t[o]?t[o].call(n):o})}}.call(this),define("bower_components/im_base/helpers/date_format",function(){}),define("bower_components/im_base/helpers/utils",["require","./date_format"],function(t){t("./date_format");var e=window.Utils||{};return _.extend(e,{postMessage:function(t,e,n){n=n||window.location.origin,t.postMessage(e,n)},getCardTitle:function(t){var e=t;return _.isString(t)&&(t=JSON.parse(t),e=t.title),e},isSupportWS:function(){return"WebSocket"in window&&2===window.WebSocket.CLOSING},isAndroid:function(){return"android"===window._global.mobile_system},isHttps:function(){return"https:"===window.location.protocol},isWeixin:function(){var t=!1;return window._global&&"weixin"===window._global.platform&&(t=!0),t},syncSocket:function(t,e,n){var i=window.socket,o=i.send(n.data,t);return o.done(function(t,e){n.success(e)}).fail(function(t,e){n.error(e)}),e.trigger("request",e,o,n),o},getSocketUrl:function(){var t,e=window._global.run_mode||"online",n=window._global.ws_env||"default";return"pre"===n?"ws://10.10.127.76:6060":t=this.isHttps()?"wss://im-ws.youzan.com:443":"online"===e?"ws://180.150.190.137:6061":"qatest"===e?"wss://im-ws.youzan.com":"ws://10.10.183.168:6060"},isTrustedDomian:function(t){var e=-1!==t.indexOf("koudaitong.com")||-1!==t.indexOf("youzan.com");return e},fixWebView:function(){return getComputedStyle(document.body).width},checkIsLogined:function(){return!!window._global.buyer_id},validToken:function(t,e){var n=this;t=t||$.Deferred();var i=this.open_token;return i?i.expires_remind>0?t.resolve(i):setTimeout(function(){n.fetchToken(t,e)},1e4):this.fetchToken(t,e),t},fetchToken:function(t,n){var i=this,o=e.site("/common/oauth/exchangetoken.json","wap"),r=e.ajax({url:o,type:"POST",data:n,xhrFields:{withCredentials:!0}}).done(function(e){i.open_token=e,i.validToken(t,n)}).fail(function(){window.motify.log("获取token失败")});return r},getToken:function(){var t=this.open_token?this.open_token.access_token:"";return t},getCardData:function(){var t=window._global.card_data||{};return t},getBuyerId:function(){var t=window._global.buyer_id||0;return t},getKdtId:function(){var t=window._global.kdt_id||0;return t},getUserInfo:function(){var t=this,e=t.getMpData(),n={pic:e.logo||"",name:e.team_name||"",alias:e.alias||""};return n},getMpData:function(){return window._global.mp_data||{}},channelMap:{youzan:"wsc",weixiaodian:"wsc",aixuedai:"wsc",pf:"ls"},getChannel:function(){var t=this,e=window._global.im_channel;if(e)return e;var n=t.getMpData(),i=n.team_type||"youzan";return e=t.channelMap[i]},getHomepage:function(t,n){var i=this;t=t||0,n=n||i.getChannel();var o="";return o="ls"===n?e.site("/wholesale/store?kdt_id="+t,"pf"):e.site("/showcase/homepage?kdt_id="+t,"wap")},isRetina:function(){return window.devicePixelRatio>1},isToday:function(t){var e=new Date,n=new Date(t);return e.toDateString()===n.toDateString()},isYesterday:function(t){var e=new Date;e.setHours(0,0,0,0);var n=new Date(t),i=+e-+n,o=i>0&&864e5>i;return o},dateFormat:function(t,e){if(!t)return"";var n=new Date(t),i=n.format(e);return i},datetimeFix:function(t){var e,n=this;return e=n.isToday(t)?n.dateFormat(t,"H:i:s"):n.isYesterday(t)?n.dateFormat(t,"昨天 H:i:s"):n.dateFormat(t,"Y/m/d H:i:s")},findLinks:function(t,e,n){n=n||"_blank";var i=/(http|ftp|https):\/\/[\w-]+(\.[\w-]+)+([\w.,@?^=%&amp;:\/~+#-]*[\w@?^=%&amp;\/~+#-])?/gi;return e=e||"external-link",t=t.replace(i,function(t){return'<a class="'+e+'" target="'+n+'" href="'+t+'">'+t+"</a>"})},notInIframe:function(){var t=window.top===window;return t},deparam:function(t){var e={};if(!t)return e;var n=t.split("&");return _(n).each(function(t){var n=t.split("=");e[n[0]]=n[1]}),e},rtrim:function(t){return t=t||"",t.replace(/(\s*$)/g,"")},url:function(t){var e=window.location.origin+"/v2",n=e+t;return n},site:function(t,e){var n=window._global.run_mode,i=window._global.url;"static"===e&&"online"===n&&(e="cdn_static");var o=t;return e=e?i[e]||"":"",-1===t.search(/^http[s]?\:\/\//)&&(o=e+t),o},fullfillImage:function(t,e,n){if(t){var i=[/^(https?:)?\/\/imgqn.koudaitong.com/,/^(https?:)?\/\/kdt-img.koudaitong.com/,/^(https?:)?\/\/img.yzcdn.cn/,/^(https?:)?\/\/dn-kdt-img.qbox.me/];n=n||{},e=e||"";for(var o=0;o<i.length;o++)t=t.replace(i[o],window._global.url.imgqn);if(t=t.replace("imgqntest.koudaitong.com","dn-kdt-img-test.qbox.me"),t.match(/^(https?:)?\/\//i)){if(!t.match(window._global.url.imgqn)&&!t.match("dn-kdt-img-test.qbox.me"))return t;t.match("!")||(t+=e)}else t=window._global.url.imgqn+"/"+t+e;return t=t.replace(/^https?:\/\//i,"//")}},ajax:function(t,e){var n=$.Deferred();return"object"==typeof t&&(e=t,t=void 0),e=_.defaults(e||{},{dataType:"json"}),n.xhr=$.ajax(e).done(function(t){void 0!==t.errcode&&(t.code=t.errcode,t.msg=t.errmsg),0===+t.code?n.resolve(t.data,t):void 0===t.code?n.resolve(t,t):n.reject(t.msg,t)}).fail(function(t,e){var i=99999;e=e||"数据错误","parsererror"===e&&(e="JSON解析失败"),"abort"===e&&(i=-1),n.reject(e,{code:i,msg:e})}),n},insertText:function(t,e){if("INPUT"===t.tagName||"TEXTAREA"===t.tagName)if(document.selection){t.focus();var n=document.selection.createRange();n.text=e,n.collapse(),n.select()}else if(t.selectionStart||"0"==t.selectionStart){var i=t.selectionStart,o=t.selectionEnd;t.value=t.value.substring(0,i)+e+t.value.substring(o,t.value.length),t.selectionStart=t.selectionEnd=i+e.length}else t.value+=e},moveCaretToStart:function(t){if("number"==typeof t.selectionStart)t.selectionStart=t.selectionEnd=0;else if("undefined"!=typeof t.createTextRange){t.focus();var e=t.createTextRange();e.collapse(!0),e.select()}},moveCaretToEnd:function(t){if("number"==typeof t.selectionStart)t.selectionStart=t.selectionEnd=t.value.length;else if("undefined"!=typeof t.createTextRange){t.focus();var e=t.createTextRange();e.collapse(!1),e.select()}}}),e}),define("text!bower_components/im_base/templates/vessel.html",[],function(){return'<iframe id="js-im-vessel" src="about:blank" width="100%" height="100%" frameborder="0"></iframe>\n'}),define("bower_components/im_base/views/vessel",["require","../helpers/utils","text!../templates/vessel.html"],function(t){var e=t("../helpers/utils"),n=t("text!../templates/vessel.html");return Backbone.View.extend({template:_.template(n),ui:{},initialize:function(t){this.config=_({}).extend(t)},render:function(t){var e=this;return t=t||{},this.$el.html(this.template(t)),this.ui.iframe=this.$("#js-im-vessel"),this.ui.iframe.on("load",function(){e.trigger("im:iframe:loaded")}),this.imWindow=this.ui.iframe[0].contentWindow,this},update:function(t){var e=this;setTimeout(function(){e.ui.iframe.attr("src",t)},50)},postData:function(t){var e=this.ui.iframe,n=e.attr("src");return"about:blank"===n?!1:void this._postData(t)},_postData:function(t){var n=e.site("","wap");n=n.replace("/v2",""),e.isAndroid()&&(n=n.replace("https://","http://")),e.postMessage(this.imWindow,t,n)}})}),define("bower_components/im_base/models/bot",["require","backbone"],function(t){var e=t("backbone");return e.Model.extend({defaults:{channel:"",version:1,pageType:"goods",alias:"",talkerId:0,unread:0},initialize:function(t){var e=this.get("pageType");"goods"===e&&this.set({alias:window._global.alias||""},{silent:!0}),this.get("talkerId")||this.set({talkerId:window._global.kdt_id||0},{silent:!0})}})}),define("bower_components/im_base/views/bot",["require","underscore","backbone","bower_components/pop/popup","bower_components/pop/popout_box","bower_components/login/main","../helpers/utils","./vessel","../models/bot"],function(t){var e,n=t("underscore"),i=t("backbone"),o=t("bower_components/pop/popup"),r=t("bower_components/pop/popout_box"),s=t("bower_components/login/main"),a=t("../helpers/utils"),c=t("./vessel"),u=t("../models/bot"),h=i.View.extend({el:"body",ui:{},initialize:function(t){this.options=n({config:{}}).extend(t),this.model=new u(this.options.config),this.listenTo(this,"im:show",this.showIm),this.listenTo(this,"im:hide",this.hideIm),this.fetchData()},setConfig:function(t){return n(this.options).extend(t||{config:{}}),this.model?void this.model.set(this.options.config):!1},fetchData:function(t){var e=this;return a.checkIsLogined()?void a.validToken().done(function(){e.fetchUnreadCount(),n.isFunction(t)&&t()}):(e.trigger("im:error",{code:11001}),!1)},fetchUnreadCount:function(){var t=this;a.ajax({url:"//wap-im.youzan.com/message/notify",type:"GET",timeout:1e4,xhrFields:{withCredentials:!0},data:{channel:a.getChannel(),buyer_id:a.getBuyerId()}}).done(function(e){var i=e.unread;return n.isNumber(i)?(t.updateUnreadCount(i),i>0?!1:void t.pollingUnreadCount(i)):!1})},pollingUnreadCount:function(){var t=this;this.timer=setTimeout(function(){t.fetchUnreadCount()},12e3)},processNewMessage:function(t){return this.trigger("message",t),this.imIsOpened?!1:void this.changeUnread(1)},showIm:function(t){this.setConfig(t),a.checkIsLogined()?a.isAndroid()&&a.isHttps()?this.navigateToIm():this.showImPop():this.showLoginModal()},navigateToIm:function(){var t=this.generateUrl({alias:window._global.alias||"",kdt_id:a.getKdtId()});window.location.href=t},hideIm:function(){return this.popupView?void this.popupView.hide():!1},showImPop:function(){var t=this;t.popupView||(t.popupView=new o({contentViewClass:c,className:"wap-im-vessel",onShow:function(){t.imIsOpened=!0,t.updateUnreadCount(0),t.closeSocket()},onHide:function(){t.imIsOpened=!1,t.notifyVessel({command:"im:hidden"})},onFinishHide:function(){},contentViewOptions:{model:t.model},doNotRemoveOnHide:!0,containerCss:{top:"60px",padding:0}}).render({}),t.handlePageNotify()),t.loadMain(),t.popupView.show(),t.notifyVessel({command:"im:shown"})},generateUrl:function(){var t=this.model.toJSON(),e=t.pageType,i={c:t.channel,v:t.version,o:t.origin,kdt_id:t.talkerId};"goods"===e&&n(i).extend({type:e,alias:t.alias});var o={id:t.talkerId,t:+new Date},r="/im?"+$.param(i)+"#talk!"+$.param(o),s=a.site(r,"wap");return a.isAndroid()&&(s=s.replace("https://","http://")),s},closeSocket:function(){return this.socket?(this.socket.close(),void(this.socket=null)):!1},notifyVessel:function(t){return this.popupView?void this.popupView.contentView.postData(t):!1},updateUnreadCount:function(t){this.model.set("unread",t),this.trigger("im:unread",{unread:t})},loadMain:function(){var t=this.generateUrl({alias:window._global.alias||"",kdt_id:a.getKdtId()});this.popupView.contentView.update(t)},showLoginModal:function(){var t=this;t.loginModal=new r({contentViewClass:s,contentViewOptions:{afterLogin:function(e){t.updateGlobalData(e.data),t.loginModal.hide(),t.fetchTokenAndShowIm()}}}).render().show()},fetchTokenAndShowIm:function(){var t=this;t.fetchData(function(){t.showImPop()})},updateGlobalData:function(t){var e=window._global;return e?(e.buyer_id=t.id,e.buyer=t,void(e.need_ajax_login=!1)):!1},handlePageNotify:function(){var t=this;window.addEventListener("message",function(e){return a.isTrustedDomian(e.origin)?void t.processCommand(e.data):!1})},changeUnread:function(t){var e=this.model.get("unread")||0,n=e+t;n=0>n?0:n,this.updateUnreadCount(n)},destroyImPop:function(){this.popupView&&(this.popupView.destroy(),this.popupView=null)},processCommand:function(t){var e=t.command,n=t.content;"im:hide"===e?this.hideIm(n):"im:unread"===e?this.updateUnreadCount(n):"im:message"===e?this.processNewMessage(n):"im:quit"===e&&this.destroyImPop()}});return{getInstance:function(t){return e?e.setConfig(t):e=new h(t),e}}}),define("text!wap/im_icon_v2/templates/icon.html",[],function(){return'<div class="js-im-icon contact-seller"></div>\n'}),define("text!wap/im_icon_v2/templates/btn.html",[],function(){return'<a href="javascript:;" class="js-open-im open-im">联系商家<% if(unread > 0) { %><i class="js-unread-dot unread-dot"><%- unread %></i><% } %></a>\n'}),define("wap/im_icon_v2/app",["require","bower_components/im_base/views/bot","text!wap/im_icon_v2/templates/icon.html","bower_components/im_base/helpers/utils","text!wap/im_icon_v2/templates/btn.html"],function(t){var e=t("bower_components/im_base/views/bot"),n=t("text!wap/im_icon_v2/templates/icon.html"),i=t("bower_components/im_base/helpers/utils"),o=t("text!wap/im_icon_v2/templates/btn.html");return Backbone.View.extend({el:"body",iconTpl:_.template(n),btnTpl:_.template(o),events:{"click .js-open-im":"onOpenImClick"},ui:{},initialize:function(t){var n=this;n.config=_({}).extend(t);var o=i.getChannel();n.bot=e.getInstance({config:{origin:window.location.origin,version:2,channel:o}}),n.renderIcon(),this.ui.imIcon=this.$(".js-im-icon"),n.renderBtn(),n.listenTo(n.bot,"im:unread",n.renderBtn)},renderIcon:function(){if(this.$(".js-im-icon").length>0)return!1;var t=this.iconTpl({});this.$el.append(t)},renderBtn:function(t){if(t=t||{unread:0},!this.ui.imIcon)return!1;var e=this.btnTpl(t);return this.ui.imIcon.html(e),this},onOpenImClick:function(t){t.preventDefault(),this.bot.trigger("im:show")}})}),require(["wap/im_icon_v2/app"],function(t){return new t}),define("main",function(){});