define("zenjs/util/number",[],function(){var t={makeRandomString:function(t){var e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";t=t||10;for(var n=0;t>n;n++)e+=i.charAt(Math.floor(Math.random()*i.length));return e}};return t}),define("bower_components/pop/pop",["require","zenjs/events","zenjs/util/number"],function(t){var e=function(){},i=t("zenjs/events"),n=t("zenjs/util/number");window.zenjs=window.zenjs||{};var o=i.extend({init:function(t){this._window=$(window);var i=n.makeRandomString();$("body").append('<div id="'+i+'"                 style="display:none; height: 100%;                 position: fixed; top: 0; left: 0; right: 0;                background-color: rgba(0, 0, 0, '+(t.transparent||".9")+');z-index:1000;opacity:0;transition: opacity ease 0.2s;"></div>'),this.nBg=$("#"+i),this.nBg.on("click",$.proxy(function(){this.isCanNotHide||this.hide()},this));var o=n.makeRandomString();$("body").append('<div id="'+o+'" class="'+(t.className||"")+'" style="overflow:hidden;visibility: hidden;"></div>'),this.nPopContainer=$("#"+o),this.nPopContainer.hide(),this.nPopContainer.css({opacity:0,position:"absolute","z-index":1e3}),t.contentViewClass&&(this.contentViewClass=t.contentViewClass,this.contentViewOptions=$.extend({el:this.nPopContainer},t.contentViewOptions||{}),this.contentView=new this.contentViewClass($.extend({onHide:$.proxy(this.hide,this)},this.contentViewOptions)),this.contentView.onHide=$.proxy(this.hide,this)),this.animationTime=t.animationTime||300,this.isCanNotHide=t.isCanNotHide,this.doNotRemoveOnHide=t.doNotRemoveOnHide||!1,this.onShow=t.onShow||e,this.onHide=t.onHide||e,this.onFinishHide=t.onFinishHide||e,this.html=t.html},render:function(t){return this.renderOptions=t||{},this.contentViewClass?this.contentView.render(this.renderOptions):this.html&&this.nPopContainer.html(this.html),this},show:function(){return this.nBg.show().css({opacity:"1","transition-property":"none"}),this.nPopContainer.show(),this.trigger("pop:show:before"),setTimeout($.proxy(function(){this.trigger("pop:show:after"),this.nPopContainer.show().css("visibility","visible"),this._doShow&&this._doShow(),this.onShow()},this),200),this},hide:function(t){t=t||{};var e=t.doNotRemove||this.doNotRemoveOnHide||!1;this._doHide&&this._doHide(),this.trigger("pop:hide:before"),setTimeout($.proxy(function(){this.nBg.css({opacity:0,"transition-property":"opacity"}),this.trigger("pop:hide:after"),setTimeout($.proxy(function(){this.nBg.hide(),this.nPopContainer.hide(),e||this.destroy()},this),200)},this),this.animationTime),this.onHide()},destroy:function(){return this.nPopContainer.remove(),this.nBg.remove(),this.contentView&&this.contentView.remove(),this}});return o}),define("bower_components/pop/pop_forbid_scroll",["require","./pop"],function(t){window.zenjs=window.zenjs||{};var e=t("./pop"),i=e.extend({init:function(t){this._super(t),this.on("pop:show:before",$.proxy(this.onBeforePopShow,this)),this.on("pop:show:after",$.proxy(this.onAfterPopShow,this)),this.on("pop:hide:after",$.proxy(this.onAfterPopHide,this))},onBeforePopShow:function(){this.top=this._window.scrollTop()},onAfterPopShow:function(){this._window.scrollTop(0),this.startShow()},onAfterPopHide:function(){var t,e=function(i){return t!==this._window.scrollTop()&&i>0?(this._window.scrollTop(t),void setTimeout($.proxy(e,this,i-1))):void setTimeout($.proxy(this.onFinishHide,this),50)};return function(){this.startHide(),t=this.top,this._window.scrollTop(t),$.proxy(e,this)(2),setTimeout($.proxy(function(){window.zenjs.popList.length<1&&$("html").css("position",this.htmlPosition)},this),200)}}(),startShow:function(){var t=window.zenjs.popList;if(t||(t=window.zenjs.popList=[]),0===t.length){var e=$("body"),i=$("html");this.htmlPosition=i.css("position"),i.css("position","relative"),this.bodyCss=(e.prop("style")||{}).cssText,this.htmlCss=(i.prop("style")||{}).cssText,$("body,html").css({overflow:"hidden",height:this._window.height()})}t.indexOf(this)<0&&t.push(this)},startHide:function(){var t=window.zenjs.popList,e=t.indexOf(this);e>-1&&t.splice(e,1),t.length<1&&($("html").attr("style",this.htmlCss||""),$("body").attr("style",this.bodyCss||""))}});return i}),define("bower_components/pop/popup",["require","./pop_forbid_scroll"],function(t){var e=t("./pop_forbid_scroll"),i=e.extend({init:function(t){this._super(t),this.onClickBg=t.onClickBg||function(){},this.onBeforePopupShow=t.onBeforePopupShow||function(){},this.onAfterPopupHide=t.onAfterPopupHide||function(){},this.nPopContainer.css(_.extend({left:0,right:0,bottom:0,background:"white"},t.containerCss||{})),this.nPopContainer.css("opacity","0"),this.nPopContainer.on("focus","input, textarea",function(t){var e=$(this),i=$(window),n=i.scrollTop(),o=e.offset().top;(0>o-n||o-n>100)&&setTimeout(function(){var t=o-70;i.scrollTop(t)},150)})},_doShow:function(){this.contentView&&this.contentView.height?this.height=this.contentView.height():this.contentView||(this.height=this.nPopContainer.height()),this.onBeforePopupShow(),$(".js-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.addClass("popup"),this.nPopContainer.css({height:this.height+"px",transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)"}),this.bodyPadding=$("body").css("padding"),$("body").css("padding","0px"),setTimeout($.proxy(function(){this.nPopContainer.css({transform:"translate3d(0,0,0)","-webkit-transform":"translate3d(0,0,0)","-webkit-transition":"all ease "+this.animationTime+"ms",transition:"all ease "+this.animationTime+"ms",opacity:1})},this)),setTimeout($.proxy(function(){this.contentView&&this.contentView.onAfterPopupShow&&this.contentView.onAfterPopupShow()},this),this.animationTime)},_doHide:function(t){this.nPopContainer.css({transform:"translate3d(0,100%,0)","-webkit-transform":"translate3d(0,100%,0)",opacity:0}),setTimeout($.proxy(function(){$("body").css("padding",this.bodyPadding),this.onAfterPopupHide()},this),this.animationTime)}});return i}),define("bower_components/pop/popout",["require","./pop_forbid_scroll"],function(t){var e=t("./pop_forbid_scroll"),i=e.extend({init:function(t){t=t||{},this._super(t),this.css=$.extend({transition:"opacity ease "+this.animationTime+"ms",top:"50%",left:"50%","-webkit-transform":"translate3d(-50%, -50%, 0)",transform:"translateY(-50%, -50%, 0)"},t.css||{}),this.nPopContainer.css(this.css)},_doShow:function(){$(".js-popout-close").click($.proxy(function(t){this.hide()},this)),this.nPopContainer.css("opacity",1),this.nPopContainer.show()},_doHide:function(t){this.nPopContainer.css({opacity:0})}});return i}),define("bower_components/pop/popout_box",["require","./popout"],function(t){var e=function(){},i=t("./popout"),n=i.extend({init:function(t){this._super(t),this._onOKClicked=t.onOKClicked||e,this._onCancelClicked=t.onCancelClicked||e,this.preventHideOnOkClicked=t.preventHideOnOkClicked||!1,this.width=t.width,this.setEventListener()},setEventListener:function(){this.nPopContainer.on("click",".js-ok",$.proxy(this.onOKClicked,this)),this.nPopContainer.on("click",".js-cancel",$.proxy(this.onCancelClicked,this))},_doShow:function(){this.boxCss={"border-radius":"4px",background:"white",width:this.width||"270px",padding:"15px"},this.nPopContainer.css(this.boxCss).addClass("popout-box"),this._super()},_doHide:function(t){this._super()},onOKClicked:function(t){this._onOKClicked(t),!this.preventHideOnOkClicked&&this.hide()},onCancelClicked:function(t){this._onCancelClicked(t),this.hide()}});return n}),define("bower_components/aes/aes",["require","exports","module"],function(t,e,i){var n=n||function(t,e){var i={},n=i.lib={},o=function(){},s=n.Base={extend:function(t){o.prototype=this;var e=new o;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},r=n.WordArray=s.extend({init:function(t,i){t=this.words=t||[],this.sigBytes=i!=e?i:4*t.length},toString:function(t){return(t||c).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes;if(t=t.sigBytes,this.clamp(),n%4)for(var o=0;t>o;o++)e[n+o>>>2]|=(i[o>>>2]>>>24-8*(o%4)&255)<<24-8*((n+o)%4);else if(65535<i.length)for(o=0;t>o;o+=4)e[n+o>>>2]=i[o>>>2];else e.push.apply(e,i);return this.sigBytes+=t,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-8*(i%4),e.length=t.ceil(i/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;e>n;n+=4)i.push(4294967296*t.random()|0);return new r.init(i,e)}}),a=i.enc={},c=a.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;t>n;n++){var o=e[n>>>2]>>>24-8*(n%4)&255;i.push((o>>>4).toString(16)),i.push((15&o).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;e>n;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-4*(n%8);return new r.init(i,e/2)}},h=a.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var i=[],n=0;t>n;n++)i.push(String.fromCharCode(e[n>>>2]>>>24-8*(n%4)&255));return i.join("")},parse:function(t){for(var e=t.length,i=[],n=0;e>n;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-8*(n%4);return new r.init(i,e)}},l=a.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},d=n.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,o=i.sigBytes,s=this.blockSize,a=o/(4*s),a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0);if(e=a*s,o=t.min(4*e,o),e){for(var c=0;e>c;c+=s)this._doProcessBlock(n,c);c=n.splice(0,e),i.sigBytes-=o}return new r.init(c,o)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});n.Hasher=d.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){d.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new p.HMAC.init(t,i).finalize(e)}}});var p=i.algo={};return i}(Math);!function(){var t=n,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp(),t=[];for(var o=0;i>o;o+=3)for(var s=(e[o>>>2]>>>24-8*(o%4)&255)<<16|(e[o+1>>>2]>>>24-8*((o+1)%4)&255)<<8|e[o+2>>>2]>>>24-8*((o+2)%4)&255,r=0;4>r&&i>o+.75*r;r++)t.push(n.charAt(s>>>6*(3-r)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var i=t.length,n=this._map,o=n.charAt(64);o&&(o=t.indexOf(o),-1!=o&&(i=o));for(var o=[],s=0,r=0;i>r;r++)if(r%4){var a=n.indexOf(t.charAt(r-1))<<2*(r%4),c=n.indexOf(t.charAt(r))>>>6-2*(r%4);o[s>>>2]|=(a|c)<<24-8*(s%4),s++}return e.create(o,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,i,n,o,s,r){return t=t+(e&i|~e&n)+o+r,(t<<s|t>>>32-s)+e}function i(t,e,i,n,o,s,r){return t=t+(e&n|i&~n)+o+r,(t<<s|t>>>32-s)+e}function o(t,e,i,n,o,s,r){return t=t+(e^i^n)+o+r,(t<<s|t>>>32-s)+e}function s(t,e,i,n,o,s,r){return t=t+(i^(e|~n))+o+r,(t<<s|t>>>32-s)+e}for(var r=n,a=r.lib,c=a.WordArray,h=a.Hasher,a=r.algo,l=[],d=0;64>d;d++)l[d]=4294967296*t.abs(t.sin(d+1))|0;a=a.MD5=h.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,n){for(var r=0;16>r;r++){var a=n+r,c=t[a];t[a]=16711935&(c<<8|c>>>24)|4278255360&(c<<24|c>>>8)}var r=this._hash.words,a=t[n+0],c=t[n+1],h=t[n+2],d=t[n+3],p=t[n+4],u=t[n+5],f=t[n+6],m=t[n+7],g=t[n+8],v=t[n+9],y=t[n+10],w=t[n+11],_=t[n+12],b=t[n+13],x=t[n+14],k=t[n+15],C=r[0],F=r[1],z=r[2],j=r[3],C=e(C,F,z,j,a,7,l[0]),j=e(j,C,F,z,c,12,l[1]),z=e(z,j,C,F,h,17,l[2]),F=e(F,z,j,C,d,22,l[3]),C=e(C,F,z,j,p,7,l[4]),j=e(j,C,F,z,u,12,l[5]),z=e(z,j,C,F,f,17,l[6]),F=e(F,z,j,C,m,22,l[7]),C=e(C,F,z,j,g,7,l[8]),j=e(j,C,F,z,v,12,l[9]),z=e(z,j,C,F,y,17,l[10]),F=e(F,z,j,C,w,22,l[11]),C=e(C,F,z,j,_,7,l[12]),j=e(j,C,F,z,b,12,l[13]),z=e(z,j,C,F,x,17,l[14]),F=e(F,z,j,C,k,22,l[15]),C=i(C,F,z,j,c,5,l[16]),j=i(j,C,F,z,f,9,l[17]),z=i(z,j,C,F,w,14,l[18]),F=i(F,z,j,C,a,20,l[19]),C=i(C,F,z,j,u,5,l[20]),j=i(j,C,F,z,y,9,l[21]),z=i(z,j,C,F,k,14,l[22]),F=i(F,z,j,C,p,20,l[23]),C=i(C,F,z,j,v,5,l[24]),j=i(j,C,F,z,x,9,l[25]),z=i(z,j,C,F,d,14,l[26]),F=i(F,z,j,C,g,20,l[27]),C=i(C,F,z,j,b,5,l[28]),j=i(j,C,F,z,h,9,l[29]),z=i(z,j,C,F,m,14,l[30]),F=i(F,z,j,C,_,20,l[31]),C=o(C,F,z,j,u,4,l[32]),j=o(j,C,F,z,g,11,l[33]),z=o(z,j,C,F,w,16,l[34]),F=o(F,z,j,C,x,23,l[35]),C=o(C,F,z,j,c,4,l[36]),j=o(j,C,F,z,p,11,l[37]),z=o(z,j,C,F,m,16,l[38]),F=o(F,z,j,C,y,23,l[39]),C=o(C,F,z,j,b,4,l[40]),j=o(j,C,F,z,a,11,l[41]),z=o(z,j,C,F,d,16,l[42]),F=o(F,z,j,C,f,23,l[43]),C=o(C,F,z,j,v,4,l[44]),j=o(j,C,F,z,_,11,l[45]),z=o(z,j,C,F,k,16,l[46]),F=o(F,z,j,C,h,23,l[47]),C=s(C,F,z,j,a,6,l[48]),j=s(j,C,F,z,m,10,l[49]),z=s(z,j,C,F,x,15,l[50]),F=s(F,z,j,C,u,21,l[51]),C=s(C,F,z,j,_,6,l[52]),j=s(j,C,F,z,d,10,l[53]),z=s(z,j,C,F,y,15,l[54]),F=s(F,z,j,C,c,21,l[55]),C=s(C,F,z,j,g,6,l[56]),j=s(j,C,F,z,k,10,l[57]),z=s(z,j,C,F,f,15,l[58]),F=s(F,z,j,C,b,21,l[59]),C=s(C,F,z,j,p,6,l[60]),j=s(j,C,F,z,w,10,l[61]),z=s(z,j,C,F,h,15,l[62]),F=s(F,z,j,C,v,21,l[63]);r[0]=r[0]+C|0,r[1]=r[1]+F|0,r[2]=r[2]+z|0,r[3]=r[3]+j|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;i[o>>>5]|=128<<24-o%32;var s=t.floor(n/4294967296);for(i[(o+64>>>9<<4)+15]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[(o+64>>>9<<4)+14]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(i.length+1),this._process(),e=this._hash,i=e.words,n=0;4>n;n++)o=i[n],i[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8);return e},clone:function(){var t=h.clone.call(this);return t._hash=this._hash.clone(),t}}),r.MD5=h._createHelper(a),r.HmacMD5=h._createHmacHelper(a)}(Math),function(){var t=n,e=t.lib,i=e.Base,o=e.WordArray,e=t.algo,s=e.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var i=this.cfg,n=i.hasher.create(),s=o.create(),r=s.words,a=i.keySize,i=i.iterations;r.length<a;){c&&n.update(c);var c=n.update(t).finalize(e);n.reset();for(var h=1;i>h;h++)c=n.finalize(c),n.reset();s.concat(c)}return s.sigBytes=4*a,s}});t.EvpKDF=function(t,e,i){return s.create(i).compute(t,e)}}(),n.lib.Cipher||function(t){var e=n,i=e.lib,o=i.Base,s=i.WordArray,r=i.BufferedBlockAlgorithm,a=e.enc.Base64,c=e.algo.EvpKDF,h=i.Cipher=r.extend({cfg:o.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,i,n){return("string"==typeof i?m:f).encrypt(t,e,i,n)},decrypt:function(e,i,n){return("string"==typeof i?m:f).decrypt(t,e,i,n)}}}});i.StreamCipher=h.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var l=e.mode={},d=function(e,i,n){var o=this._iv;o?this._iv=t:o=this._prevBlock;for(var s=0;n>s;s++)e[i+s]^=o[s]},p=(i.BlockCipherMode=o.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();p.Encryptor=p.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize;d.call(this,t,e,n),i.encryptBlock(t,e),this._prevBlock=t.slice(e,e+n)}}),p.Decryptor=p.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,o=t.slice(e,e+n);i.decryptBlock(t,e),d.call(this,t,e,n),this._prevBlock=o}}),l=l.CBC=p,p=(e.pad={}).Pkcs7={pad:function(t,e){for(var i=4*e,i=i-t.sigBytes%i,n=i<<24|i<<16|i<<8|i,o=[],r=0;i>r;r+=4)o.push(n);i=s.create(o,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},i.BlockCipher=h.extend({cfg:h.cfg.extend({mode:l,padding:p}),reset:function(){h.reset.call(this);var t=this.cfg,e=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=t.createEncryptor;else i=t.createDecryptor,this._minBufferSize=1;this._mode=i.call(t,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var u=i.CipherParams=o.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),l=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return t=t.salt,(t?s.create([1398893684,1701076831]).concat(t).concat(e):e).toString(a)},parse:function(t){t=a.parse(t);var e=t.words;if(1398893684==e[0]&&1701076831==e[1]){var i=s.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return u.create({ciphertext:t,salt:i})}},f=i.SerializableCipher=o.extend({cfg:o.extend({format:l}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var o=t.createEncryptor(i,n);return e=o.finalize(e),o=o.cfg,u.create({ciphertext:e,key:i,iv:o.iv,algorithm:t,mode:o.mode,padding:o.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),e=(e.kdf={}).OpenSSL={execute:function(t,e,i,n){return n||(n=s.random(8)),t=c.create({keySize:e+i}).compute(t,n),i=s.create(t.words.slice(e),4*i),t.sigBytes=4*e,u.create({key:t,iv:i,salt:n})}},m=i.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:e}),encrypt:function(t,e,i,n){return n=this.cfg.extend(n),i=n.kdf.execute(i,t.keySize,t.ivSize),n.iv=i.iv,t=f.encrypt.call(this,t,e,i.key,n),t.mixIn(i),t},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),i=n.kdf.execute(i,t.keySize,t.ivSize,e.salt),n.iv=i.iv,f.decrypt.call(this,t,e,i.key,n)}})}(),function(){for(var t=n,e=t.lib.BlockCipher,i=t.algo,o=[],s=[],r=[],a=[],c=[],h=[],l=[],d=[],p=[],u=[],f=[],m=0;256>m;m++)f[m]=128>m?m<<1:m<<1^283;for(var g=0,v=0,m=0;256>m;m++){var y=v^v<<1^v<<2^v<<3^v<<4,y=y>>>8^255&y^99;o[g]=y,s[y]=g;var w=f[g],_=f[w],b=f[_],x=257*f[y]^16843008*y;r[g]=x<<24|x>>>8,a[g]=x<<16|x>>>16,c[g]=x<<8|x>>>24,h[g]=x,x=16843009*b^65537*_^257*w^16843008*g,l[y]=x<<24|x>>>8,d[y]=x<<16|x>>>16,p[y]=x<<8|x>>>24,u[y]=x,g?(g=w^f[f[f[b^w]]],v^=f[f[v]]):g=v=1}var k=[0,1,2,4,8,16,32,64,128,27,54],i=i.AES=e.extend({_doReset:function(){for(var t=this._key,e=t.words,i=t.sigBytes/4,t=4*((this._nRounds=i+6)+1),n=this._keySchedule=[],s=0;t>s;s++)if(i>s)n[s]=e[s];else{var r=n[s-1];s%i?i>6&&4==s%i&&(r=o[r>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r]):(r=r<<8|r>>>24,r=o[r>>>24]<<24|o[r>>>16&255]<<16|o[r>>>8&255]<<8|o[255&r],r^=k[s/i|0]<<24),n[s]=n[s-i]^r}for(e=this._invKeySchedule=[],i=0;t>i;i++)s=t-i,r=i%4?n[s]:n[s-4],e[i]=4>i||4>=s?r:l[o[r>>>24]]^d[o[r>>>16&255]]^p[o[r>>>8&255]]^u[o[255&r]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,r,a,c,h,o)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,l,d,p,u,s),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,o,s,r,a){for(var c=this._nRounds,h=t[e]^i[0],l=t[e+1]^i[1],d=t[e+2]^i[2],p=t[e+3]^i[3],u=4,f=1;c>f;f++)var m=n[h>>>24]^o[l>>>16&255]^s[d>>>8&255]^r[255&p]^i[u++],g=n[l>>>24]^o[d>>>16&255]^s[p>>>8&255]^r[255&h]^i[u++],v=n[d>>>24]^o[p>>>16&255]^s[h>>>8&255]^r[255&l]^i[u++],p=n[p>>>24]^o[h>>>16&255]^s[l>>>8&255]^r[255&d]^i[u++],h=m,l=g,d=v;m=(a[h>>>24]<<24|a[l>>>16&255]<<16|a[d>>>8&255]<<8|a[255&p])^i[u++],g=(a[l>>>24]<<24|a[d>>>16&255]<<16|a[p>>>8&255]<<8|a[255&h])^i[u++],v=(a[d>>>24]<<24|a[p>>>16&255]<<16|a[h>>>8&255]<<8|a[255&l])^i[u++],p=(a[p>>>24]<<24|a[h>>>16&255]<<16|a[l>>>8&255]<<8|a[255&d])^i[u++],t[e]=m,t[e+1]=g,t[e+2]=v,t[e+3]=p},keySize:8});t.AES=e._createHelper(i)}(),n.pad.Iso10126={pad:function(t,e){var i=4*e,i=i-t.sigBytes%i;t.concat(n.lib.WordArray.random(i-1)).concat(n.lib.WordArray.create([i<<24],1))},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},i.exports=n}),define("bower_components/aes/main",["require","./aes"],function(t){var e=t("./aes"),i=e.enc.Utf8.parse("youzan.com.aesiv"),n=e.enc.Utf8.parse("youzan.com._key_");return{encrypt:function(t){return t=e.enc.Utf8.parse(t),e.AES.encrypt(t,n,{mode:e.mode.CBC,padding:e.pad.Iso10126,iv:i}).toString()}}}),define("text!bower_components/login/templates/init.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>请填写您的手机号码</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="" value="<%= phone %>">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <input type="submit" class="js-confirm btn btn-green btn-block font-size-14" value="确认手机号码" />\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/login.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>该号码注册过，请直接登录</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" placeholder="请输入登录密码">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">\n            <%= showBindText ? \'登录并绑定\' : \'确认\' %>\n        </button>\n    </div>\n    <div class="bottom-tips font-size-12">\n        <span class="c-orange">如果您忘了密码，请</span><a href="javascript:;" class="js-change-pwd c-blue">点此找回密码</a>\n        <a href="javascript:;" class="js-change-phone c-blue pull-right">更换手机号</a>\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/register.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2>注册有赞帐号</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item js-image-verify hide">\n            <label for="verifycode">身份校验</label>\n            <input id="verifycode" name="verifycode" class="js-verify-code item-input"  type="tel" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入右侧数字">\n            <img class="js-verify-image verify-image" src="">\n        </div>\n        <div class="form-item">\n            <label for="code">验证码</label>\n            <input id="code" name="code"  type="text" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入短信验证码">\n            <button type="button" class="js-auth-code tag btn-auth-code tag-green font-size-12" data-text="获取验证码">\n                获取验证码\n            </button>\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" maxlength="20" placeholder="请输入8-20位数字和字母组合">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">\n            <%= showBindText ? \'注册并绑定\' : \'确认\' %>\n        </button>\n    </div>\n    <div class="bottom-tips font-size-12">\n        <span class="c-orange">如果您忘了密码，请</span><a href="javascript:;" class="js-change-pwd c-blue">点此找回密码</a>\n        <a href="javascript:;" class="js-change-phone c-blue pull-right">更换手机号</a>\n    </div>\n</form>\n'}),define("text!bower_components/login/templates/change_pwd.html",[],function(){return'<form class="js-login-form popout-login" method="GET" action="">\n    <div class="header c-green center">\n        <h2><%if(isSetting){%>设定<%}else{%>找回<%}%>帐号密码</h2>\n    </div>\n    <fieldset class="wrapper-form font-size-14">\n        <div class="form-item">\n            <label for="phone">手机号</label>\n            <input id="phone" name="phone" type="tel" maxlength="11" autocomplete="off" placeholder="请输入你的手机号" disabled="disabled" value="<%= phone %>">\n        </div>\n        <div class="form-item js-image-verify hide">\n            <label for="verifycode">身份校验</label>\n            <input id="verifycode" name="verifycode" class="js-verify-code item-input"  type="tel" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入右侧数字">\n            <img class="js-verify-image verify-image" src="">\n        </div>\n        <div class="form-item">\n            <label for="code">验证码</label>\n            <input id="code" name="code"  type="text" style="width:178px" maxlength="6" autocomplete="off" placeholder="输入短信验证码">\n            <button type="button" class="js-auth-code tag btn-auth-code font-size-12 tag-green" data-text="获取验证码">\n                获取验证码\n            </button>\n        </div>\n        <div class="form-item">\n            <label for="password">密码</label>\n            <input id="passsword" name="password"  type="password" autocomplete="off" placeholder="设置新的8-20位数字和字母组合密码">\n        </div>\n        <div class="js-help-info font-size-12 error c-orange"></div>\n    </fieldset>\n    <div class="action-container">\n        <button type="button" class="js-confirm btn btn-green btn-block font-size-14">确定</button>\n    </div>\n    <div class="bottom-tips pull-right">\n        <a href="javascript:;" class="js-login inline-item c-blue">已有帐号登录</a>\n        <a href="javascript:;" class="js-register inline-item c-blue">注册新帐号</a>\n    </div>\n</form>\n'}),define("zenjs/util/valid",[],function(){window.zenjs=window.zenjs||{};var t={validMobile:function(t){return t=""+t,/^((\+86)|(86))?(1)\d{10}$/.test(t)},validPhone:function(t){return t=""+t,/^0[0-9\-]{10,13}$/.test(t)},validNumber:function(t){return/^\d+$/.test(t)},validEmail:function(t){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(t)},validPostalCode:function(t){return t=""+t,/^\d{6}$/.test(t)}};return window.zenjs.Valid=t,t}),window.Zepto&&function(t){t.fn.serializeArray=function(){var e,i,n=[],o=function(t){return t.forEach?t.forEach(o):void n.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(n,s){i=s.type,e=s.name,e&&"fieldset"!=s.nodeName.toLowerCase()&&!s.disabled&&"submit"!=i&&"reset"!=i&&"button"!=i&&"file"!=i&&("radio"!=i&&"checkbox"!=i||s.checked)&&o(t(s).val())}),n},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var i=t.Event("submit");this.eq(0).trigger(i),i.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),define("vendor/zepto/form",function(){}),define("zenjs/util/form",["require","exports","module","vendor/zepto/form","jquery"],function(t,e,i){t("vendor/zepto/form");var n=t("jquery");window.zenjs=window.zenjs||{};var o={getFormData:function(t){var e=t.serializeArray(),i={};return n.map(e,function(t){i[t.name]=t.value}),i}};window.zenjs.Form=o,i.exports=o}),define("zenjs/sms_fetch/main",["require","exports","module","bower_components/ajax/ajax","jquery"],function(t,e,i){function n(){this.loadingLock=!1,this.isUsed=void 0}function o(t){t=t||{},this.$el=s(t.el||t.$el||"<div></div>"),this.el=this.$el[0],this.$=function(t){return this.$el.find(t)},this.initialize&&this.initialize(t)}t("bower_components/ajax/ajax");var s=t("jquery"),r=function(){};n.prototype={fetch:function(){if(this.isUsed!==!1){var t=this;this.loadingLock=!0,s._ajax({url:window._global.url.www.replace(/^https?:\/\//,"//")+"/common/token/token.jsonp",type:"get",dataType:"jsonp"}).done(function(e){0==e.code?(t.token=e.data,t.loadingLock=!1,t.isUsed=!1):motify.log(e.msg)}).fail(function(){motify.log("token 获取失败")})}},get:function(){return this.isUsed=!0,this.token}};var a=new n;s.extend(o.prototype,{initialize:function(t){this.duration=t.time||60,this.step=t.step||1100,this.codeVerifyClass=t.codeVerifyClass||"js-verify-code",this.verifyType="smsFetch";var e=window._global.url.www.replace(/^https?:\/\//,"//");this.smsFetchUrl=e+"/common/sms/captcha.jsonp",this.imgUrl=e+"/common/sms/imgcaptcha",this.imgVerifyUrl=e+"/common/sms/imgcaptcha.jsonp",this.biz=t.biz||"kdt_account_captcha",this.onTimeChange=t.onTimeChange||r,this.onTimeEnd=t.onTimeEnd||r,this.onTimerStart=t.onTimerStart||r,this.onTimerClose=t.onTimerClose||r,this.onVerifyPictureShow=t.onVerifyPictureShow||r,this.onGetCodeError=t.onGetCodeError||r,this.onVerifyPictureSuccess=t.onVerifyPictureSuccess||r,this.onVerifyPictureError=t.onVerifyPictureError||r,this.platform=t.platform||"",this.subFrom=t.subFrom||"",a.fetch()},setMobile:function(t){t&&(this.mobile=t)},getImageCode:function(){return s.trim(this.$("."+this.codeVerifyClass).val())},getSms:function(t){var e=this;if(a.loadingLock)return void motify.log("数据加载中，稍后再试");if(t=t||{},t.mobile&&(this.mobile=t.mobile),!this.mobile)return!1;var i={smsFetch:e.onSmsFetchHandler,image:e.onImageHandler};return e.startTimer.call(e),(i[e.verifyType]||r).call(e),this},startTimer:function(){this.onTimerStart(),this.btnCountdown(this.duration)},stopTimer:function(){clearTimeout(this.timer),this.onTimerClose()},btnCountdown:function(t){var e=this;this.onTimeChange({second:t}),--t>=0?this.timer=setTimeout(function(){e.btnCountdown(t)},this.step):(this.onTimeEnd(),
this.timer="")},onVerifyImageShow:function(t){this.$(".js-image-verify").removeClass("hide"),this.$(".js-verify-image").attr("src",t)},onVerifyImageHide:function(){this.$(".js-image-verify").addClass("hide")},onSmsFetchHandler:function(){var t=1;return function(){var e=this,i={verifyTimes:t,mobile:this.mobile,biz:this.biz,token:a.get()};this.platform&&(i.platform=this.platform),this.subFrom&&(i.sub_from=this.subFrom),s._ajax({url:this.smsFetchUrl,dataType:"jsonp",data:i,success:function(i){return 0==i.code?void t++:(e.stopTimer.call(e),e.onGetCodeError.call(e),void(10111===i.code?(e.verifyType="image",e.onVerifyImageShow(e.imgUrl),e.onVerifyPictureShow()):(t++,motify.log(i.msg))))},error:function(i,n,o){t++,e.stopTimer.call(e),e.onGetCodeError.call(e),motify.log("获取验证码失败，请稍后再试")},complete:function(t,e){}}).always(function(){a.fetch()})}}(),onImageHandler:function(){var t=this,e=this.mobile;s._ajax({url:this.imgVerifyUrl,dataType:"jsonp",data:{mobile:e,captcha_code:this.getImageCode()},success:function(i){return 0===i.code?(t.verifyType="smsFetch",t.mobile=e,t.onVerifyImageHide(),t.onVerifyPictureSuccess(),void t.onSmsFetchHandler()):(t.stopTimer.call(t),t.onVerifyPictureError.call(t),void(10100===i.code?(motify.log(i.msg),t.$el.find(".js-verify-image").attr("src",t.imgUrl)):motify.log(i.msg)))},error:function(e,i,n){t.stopTimer.call(t),t.onVerifyPictureError.call(t),motify.log("图形验证失败，重试一下吧~"),t.$el.find(".js-verify-image").attr("src",t.imgUrl)},complete:function(t,e){}})}}),i.exports=o}),define("zenjs/util/url_helper",[],function(){var t={site:function(t,e){var i=window._global.env,n=window._global.url;"static"===e&&"online"===i&&(e="cdn_static");var o=t;return e=e?n[e]||"":"",-1==t.search(/^http[s]?\:\/\//)&&("/"!==t[0]&&(t="/"+t),o=e+t),o},getCdnImageUrl:function(t,e){if(!t)return window._global.url.cdn_static+"/image/wap/no_pic.png";if(e=t.match(/.+\!\d+x\d+.+/)?"":e&&e.length>0?e:"!100x100.jpg",t.match(/^(https?:)?\/\//i)){for(var i=[/^(https?:)?\/\/imgqn.koudaitong.com/,/^(https?:)?\/\/kdt-img.koudaitong.com/,/^(https?:)?\/\/img.yzcdn.cn/,/^(https?:)?\/\/dn-kdt-img.qbox.me/],n=0;n<i.length;n++)t=t.replace(i[n],window._global.url.imgqn);return t+e}return window._global.url.imgqn+"/"+t+e}};return t}),define("bower_components/login/main",["require","bower_components/ajax/ajax","jquery","backbone","bower_components/aes/main","text!./templates/init.html","text!./templates/login.html","text!./templates/register.html","text!./templates/change_pwd.html","zenjs/util/valid","zenjs/util/form","zenjs/sms_fetch/main","zenjs/util/url_helper","zenjs/util/ua"],function(t){t("bower_components/ajax/ajax");var e=t("jquery"),i=t("backbone"),n=t("bower_components/aes/main"),o=t("text!./templates/init.html"),s=t("text!./templates/login.html"),r=t("text!./templates/register.html"),a=t("text!./templates/change_pwd.html"),c=t("zenjs/util/valid"),h=t("zenjs/util/form"),l=t("zenjs/sms_fetch/main"),d=t("zenjs/util/url_helper"),p=t("zenjs/util/ua"),u=["youzanmars"],f=i.View.extend({events:{"click .js-confirm":"onConfirmClicked","click .js-change-phone":"onChangePhoneClicked","click .js-change-pwd":"onChangePwdClicked","click .js-login":"onLoginClicked","click .js-register":"onRegisterClicked","click .js-auth-code":"onAuthcodeClicked","submit .js-login-form":"onConfirmClicked"},initialize:function(t){t=t||{};var i=p.getPlatform();if(u.indexOf(i)>-1)return void(window.location.href=d.site("/buyer/kdtunion?redirect_uri="+encodeURIComponent(window.location.href),"wap"));var n=this,c=_global.url;this.tpl_map={init:_.template(t.initTpl||o),login:_.template(t.loginTpl||s),register:_.template(t.registerTpl||r),changePwd:_.template(t.changePwdTpl||a)},this.valid_map={checkPhone:_(this.checkPhone).bind(this),checkPwd:_(this.checkPwd).bind(this),checkCode:_(this.checkCode).bind(this)},this.renderOpt=t.renderOpt||{type:"init",phone:""},this.renderOpt.showBindText=p.isWeixin()||p.isQQ(),this.urlMap={login:t.loginUrl||c.uic+"/buyer/auth/authlogin.json",register:t.registerUrl||c.uic+"/buyer/auth/authRegister.json",changePwd:t.changePwdUrl||c.uic+"/buyer/auth/changePassword.json",confirm:t.confirmUrl||c.uic+"/buyer/auth/authConfirm.json"},this.source=t.source||2,this.ajaxType=t.ajaxType||"POST",this.afterLogin=t.afterLogin||function(){};var h,f;p.isMobile()?(h="app",f="wsc",p.isWxd()?f="wxd":p.isWsc()?f="wsc":p.isPf()?f="pf":h="wap"):h="pc",this.sms=new l({el:this.$el,onTimeChange:function(t){var i=t.second;e(n.nAuthCode).text("等待 "+i+"秒")},onTimeEnd:function(){n.nAuthCode.text("再次获取"),n.nAuthCode.prop("disabled",!1),n.nAuthCode.removeClass("disabled"),n.nCodeInput.attr("placeholder","没有收到验证码？")},onTimerStart:function(){n.nAuthCode.prop("disabled",!0),n.nAuthCode.addClass("disabled")},onVerifyPictureError:function(){n.nAuthCode.removeAttr("disabled"),n.nAuthCode.removeClass("disabled"),n.nAuthCode.text("再次获取")},onGetCodeError:function(){n.nAuthCode.removeAttr("disabled"),n.nAuthCode.removeClass("disabled"),n.nAuthCode.text("再次获取")},onVerifyPictureShow:function(){n.nHelpInfo.html("操作过于频繁，请先输入图像验证码再获取")},onVerifyPictureSuccess:function(){n.nHelpInfo.html("")},platform:h,subFrom:f})},render:function(){return this.appLogined?this:(this.$el.html(this.tpl_map[this.renderOpt.type](this.renderOpt)),this.nForm=this.$(".js-login-form"),this.nHelpInfo=this.$(".js-help-info"),this.nPhone=this.$('input[name="phone"]'),this.nPwd=this.$('input[name="password"]'),this.nCodeInput=this.$('input[name="authcode"]'),this.nAuthCode=this.$(".js-auth-code"),this)},show:function(t,e){"changePwd"==t?this.sms.biz="reset_account_passwd":this.sms.biz="kdt_account_captcha",_.extend(this.renderOpt,{type:t},e||{isSetting:!1}),this.render(this.renderOpt),this.$el.show(this.animationTime)},onConfirmClicked:function(t){t.preventDefault();var i=this,o=e(t.target),s=h.getFormData(i.nForm);if(s=_.extend(i.renderOpt,s),!i.validate(s))return!1;s.source=this.source,s.password&&(s.password=n.encrypt(s.password));var r=o.html();if("init"===i.renderOpt.type)i.renderOpt.phone=s.phone,e._ajax({url:this.urlMap.confirm,type:"POST",dataType:"json",timeout:15e3,data:s,xhrFields:{withCredentials:!0},beforeSend:function(){o.html("确认中..."),o.prop("disabled",!0)},success:function(t){switch(+t.code){case 0:i.show("login");break;case 135000003:i.show("register");break;default:i.nHelpInfo.html(t.msg)}},error:function(){i.nHelpInfo.html("出错啦，请重试")},complete:function(){o.html(r),o.prop("disabled",!1)}});else{var a=i.renderOpt.type;e._ajax({url:this.urlMap[a],type:this.ajaxType,dataType:"json",timeout:15e3,data:s,xhrFields:{withCredentials:!0},beforeSend:function(){o.html("确认中..."),o.prop("disabled",!0)},success:function(t){0===t.code?i.afterLogin(t,{type:a}):i.nHelpInfo.html(t.msg)},error:function(){i.nHelpInfo.html("出错啦，请重试")},complete:function(){o.html(r),o.prop("disabled",!1)}})}},onAuthcodeClicked:function(t){t.preventDefault();var e=this,i=h.getFormData(e.nForm);i=_.extend(e.renderOpt,i);var n=i.phone;this.sms.setMobile(n),this.sms.getSms()},onChangePhoneClicked:function(t){t.preventDefault(),this.show("init")},onChangePwdClicked:function(t){t.preventDefault(),this.sms.stopTimer(),this.show("changePwd")},onLoginClicked:function(t){t.preventDefault(),this.show("init")},onRegisterClicked:function(t){t.preventDefault(),this.show("init")},validate:function(){var t={init:["checkPhone"],login:["checkPwd"],register:["checkCode","checkPwd"],changePwd:["checkCode","checkPwd"]};return function(e){return _.every(t[e.type],_(function(t){return this.valid_map[t](e)}).bind(this))}}(),checkPhone:function(t){return""===t.phone?(this.nPhone.focus(),this.nHelpInfo.html("请填写您的手机号码"),!1):c.validMobile(t.phone)?!0:(this.nPhone.focus(),this.nHelpInfo.html("请填写11位手机号码"),!1)},checkPwd:function(t){function e(t){var e=/[a-zA-Z]/g,i=/[0-9]/g,n=0,o=e.test(t),s=i.test(t);return o&&s&&(n=1),n}if(""===t.password)return this.nPwd.focus(),this.nHelpInfo.html("请输入您的密码"),!1;if("login"!==this.renderOpt.type&&t.password.length<8)return this.nPwd.focus(),this.nHelpInfo.html("亲，密码最短为8位"),!1;if("login"!==this.renderOpt.type&&t.password.length>20)return this.nPwd.focus(),this.nHelpInfo.html("亲，密码最长为20位"),!1;if("login"!==this.renderOpt.type){var i=e(t.password);if(!i)return this.nPwd.focus(),this.nHelpInfo.html("亲，密码为8-20位数字和字母组合"),!1}return!0},checkCode:function(t){return c.validPostalCode(t.code)?!0:(this.nCodeInput.focus(),this.nHelpInfo.html("请填写6位短信验证码"),!1)}});return f}),define("bower_components/waterfall/pager",["require","zenjs/events"],function(t){var e=t("zenjs/events"),i=function(){};return e.extend({init:function(t){this.$el||(this.$el=$(t.el||t.$el||"<div></div>"),this.el=this.$el[0]),this.nLoading=t.loadingHTML?$(t.loadingHTML).addClass("loading-more"):$('<div class="loading-more"><span></span></div>'),this.nList=this.$el.find(".js-list"),0===this.nList.length&&(this.nList=$('<div class="js-list b-list"></div>'),this.$el.append(this.nList)),"number"==typeof t.total&&(this.total=t.total),this.offset=t.offset||300,this.scrollDirection="down",this.pageIndex=t.pageIndex||0,this.perPage=t.perPage||10,this.postData=t.postData||{},this.checkSize=!0,"boolean"==typeof t.checkSize&&(this.checkSize=t.checkSize),this.idName=t.idName||"id",t.idValue&&(this.idValue=t.idValue),this.jsonKeys=t.jsonKeys||{},this.finishedHTML=t.finishedHTML,this.finishedText=t.finishedText,this.emptyHTML=t.emptyHTML||"",this.emptyText=t.emptyText||"",this.getExtrPostData=t.getExtrPostData||i,this.onFetchError=t.onFetchError||i,this.onListEmpty=this.onListEmpty||t.onEmpty||this._onListEmpty,this.on("finished",t.onFinished||i),this.on("after:list:load",t.onAfterListLoad||t.onDataLoad||i),this.extraData={},this.scrollContainer=t.scrollContainer?$(t.scrollContainer):$("body"),this.scrollEventAccepter=t.scrollEventAccepter?$(t.scrollEventAccepter):$(t.scrollContainer||window),this._onScroll=$.proxy(this.onScroll,this),this.bindScrollFunc()},$:function(t){return this.$el.find(t)},onScroll:function(){function t(){var t=this.nList.offset(),e=this.scrollContainer.offset(),i={left:t.left-e.left||0,top:t.top-e.top||0};return i}return function(){if(!(this.sleeping||this.finished||this.fetching)){if(0===this.total||this.total&&this.total<=this.pageIndex*this.perPage)return void this.doFinishLoading();var e=t.call(this);"down"===this.scrollDirection&&this.nList.height()+e.top-this.scrollEventAccepter.height()-this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore(),"up"===this.scrollDirection&&this.scrollContainer.scrollTop()<this.offset&&this.fetchMore&&this.fetchMore()}}}(),fetchMore:function(){return this.sleeping||this.finished||this.fetching?this:(this.showLoading(),this.fetching=!0,this._fetchMore&&this._fetchMore.call(this),this)},onFetchMoreSuccess:function(){this.hideLoading(),this.fetching=!1,this._onFetchMoreSuccess.apply(this,arguments)},fetchRender:function(){return this.fetchMore(),this},_onFetchMoreError:function(){this.fetching=!1,this.hideLoading(),this.onFetchError()},doFinishLoading:function(t){this.finished=!0,this.fetching=!1,this.hideLoading(),this.$el.find(".list-finished").remove(),this.triggerMethod&&this.triggerMethod("finished",this.collection,t)},bindScrollFunc:function(){var t=this;this.scrollFunc&&this.unbindScrollFunc(),this.scrollFunc=function(){t.scrollTimeout&&clearTimeout(t.scrollTimeout),t.scrollTimeout=setTimeout(t._onScroll,200)},this.scrollEventAccepter.on("scroll",this.scrollFunc)},unbindScrollFunc:function(){this.scrollEventAccepter.off("scroll",this.scrollFunc),this.scrollFunc=null},doSleep:function(){this.sleeping=!0,this.unbindScrollFunc()},doWake:function(){this.sleeping=!1,this.bindScrollFunc(),this.fetchMore()},showLoading:function(){this.hasFetching=!0,this.$el.append(this.nLoading)},hideLoading:function(){this.nLoading.remove()},getFinishHtml:function(){var t;return t=this.finishedHTML?$(this.finishedHTML).addClass("list-finished"):'<div class="list-finished">'+(this.finishedText||"已经没有更多了")+"</div>"},setExtraData:function(t){$.extend(this.extraData,t)},resetWaterfall:function(t){this.finished===!0&&this.$(".list-finished").remove(),this.removeAll&&this.removeAll(),this.nList.empty(),this.collection&&this.collection.reset([],{silent:!0}),this.listEl&&this.listEl.empty(),this.finished=!1,t&&t.pageIndex?this.pageIndex=t.pageIndex:this.pageIndex=0,this.idValue=void 0},_onListEmpty:function(){if(!this.fetching){var t;this.emptyHTML?t=$(this.emptyHTML).addClass("list-finished"):this.emptyText&&(t='<div class="list-finished">'+this.emptyText+"</div>"),this.$el.append(t)}},destroy:function(){this.doSleep(),this.$el.remove(),this.unbindScrollFunc()},remove:function(){this.destroy()}})}),define("zenjs/backbone/base_view",["require","backbone","../core/trigger_method"],function(t){var e=t("backbone"),i=t("../core/trigger_method");return e.View.extend({clean:function(){return this.stopListening(),this},triggerMethod:i})}),define("bower_components/zenlist/list",["require","exports","module","zenjs/backbone/base_view"],function(t,e,i){var n=function(){},o=t("zenjs/backbone/base_view");i.exports=o.extend({initialize:function(t){return this.options=t=t||{},this.items=[],this.itemView=t.itemView,this.itemOptions=t.itemOptions||{},this.collection=t.collection,this.onAfterListChange=t.onAfterListChange||n,this.onAfterListLoad=t.onAfterListLoad||n,this.onAfterListDisplay=t.onAfterListDisplay||n,this.onListEmpty=t.onListEmpty||t.onEmptyList||this._onListEmpty,this.onItemClick=t.onItemClick||n,this.onViewItemAdded=t.onViewItemAdded||n,this.displaySize=t.displaySize||-1,this.emptyHTML=t.emptyHTML||"",this.emptyText=t.emptyText||"列表为空",this},render:function(t){return this.displaySize=-1==(t||{}).displaySize?-1:this.displaySize,this.clean(),this._setupListeners(),this.addAll(),this.onAfterListDisplay({list:this.collection}),this},fetchRender:function(t){return this.collection.fetch({data:t,success:_(function(t,e){this.render(),this.onAfterListLoad(this.collection,e),this.onFetchSuccess&&this.onFetchSuccess()}).bind(this),error:_.bind(function(){this.onAfterListLoad(this.collection,response)},this)}),this},_setupListeners:function(){this.collection&&(this.stopListening(this.collection),this.listenTo(this.collection,"add",this.addItem,this),this.listenTo(this.collection,"reset sort",this.render,this),this.listenTo(this.collection,"remove",this.onItemRemoved,this))},addItemListeners:function(t){var e=this;this.listenTo(t,"all",function(){var e="item:"+arguments[0],i=_.toArray(arguments);i.splice(0,1),i.unshift(e,t),this.trigger.apply(this,i),"item:click"==e&&this.onItemClick()}),this.listenTo(t.model,"change",function(){e.onAfterListChange({list:this.collection})})},addAll:function(){0===this.collection.length?this.fetching||this.triggerMethod("list:empty"):this.collection.each(function(t){this.addItem(t)},this)},removeAll:function(){for(var t=this.items.length-1;t>=0;t--)this.removeView(this.items[t]);this.onAfterListChange({list:this.collection})},addItem:function(t,e,i){if(!(this.displaySize>=0&&this.items.length>=this.displaySize)){1==this.collection.length&&(this.listEl||this.$el).html("");var n=new this.itemView(_.extend({},this.options.itemOptions,{model:t,index:this.collection.indexOf(t)}));this.items.push(n),this.addItemListeners(n),n.render(),this.onViewItemAdded({list:this.items,viewItem:n,model:t});var o=(i||{}).at;return 0===o?(this.listEl||this.$el).prepend(n.el):(this.listEl||this.$el).append(n.el),n}},removeItem:function(t){var e=this.getViewByModel(t);e&&this.removeView(e)},removeView:function(t){var e;this.stopListening(t),t&&(this.stopListening(t.model),t.remove(),e=this.items.indexOf(t),this.items.splice(e,1)),0===this.collection.length&&(this.fetching||this.triggerMethod("list:empty"))},onItemRemoved:function(t){this.onAfterListChange({list:this.collection,action:"remove",model:t}),this.removeItem(t)},getViewByModel:function(t){return _.find(this.items,function(e,i){return e.model===t})},dispatchEventToAllViews:function(t,e){for(var i=this.items.length-1;i>=0;i--)this.items[i].trigger(t,e)},remove:function(){o.prototype.remove.call(this,arguments),this.removeAll(),this.collection.reset(),delete this.collection},clean:function(){o.prototype.clean.call(this,arguments),this.removeAll(),(this.listEl||this.$el).html(""),this.stopListening(this.collection)},_onListEmpty:function(){this.$el.html(this.emptyHTML||(this.emptyText?'<p style="text-align:center;line-height:60px;">'+this.emptyText+"</p>":""))}})}),define("bower_components/waterfall/waterfall",["require","./pager","bower_components/zenlist/list"],function(t){var e=t("./pager"),i=t("bower_components/zenlist/list"),n=function(){},o=e.extend({init:function(t){this._super(t),this.collection=t.collection,this.listEl=this.getListViewEl(),this.list=new i($.extend({},t,{el:this.listEl,collection:this.collection,onListEmpty:n})).render(),this.on("finished",this._doFinishLoading)},getListViewEl:function(){return this.nList},_fetchMore:function(){var t={};this.idValue&&(t[this.idName]=this.idValue),t[this.jsonKeys.perPage||"perpage"]=this.perPage,t[this.jsonKeys.pageIndex||"page"]=this.pageIndex+1;var e=this.getExtrPostData?this.getExtrPostData():{};this.collection.fetch({data:$.extend(t,this.postData,e,this.extraData),success:$.proxy(this.onFetchMoreSuccess,this),error:$.proxy(this.onFetchError,this),update:!0,remove:!1})},_onFetchMoreSuccess:function(t,e){this.pageIndex++,this.triggerMethod("after:list:load",{collection:t,response:e});var i=this.collection.parse(e);if(0===i.length||this.checkSize&&i.length<this.perPage)return void this.doFinishLoading();var n=_.last(this.collection.models);n&&(this.idValue=n.get(this.idName)),this.onScroll()},_onAfterListLoad:function(){var t=_.last(this.collection.models);t&&(this.idValue=t.get(this.idName))},_doFinishLoading:function(){if(this.collection.length>0){if(this.hasFetching&&this.pageIndex>1){var t=this.getFinishHtml();this.$el.append(t)}}else this.triggerMethod("list:empty")},addTopItem:function(t){this.collection.unshift(t)},addBottomItem:function(t){this.finished===!0&&this.$(".list-finished").remove(),this.collection.add(t)}});return o}),define("wap/trade/lucky_money/collections/lucky_list",[],function(){return Backbone.Collection.extend({model:Backbone.Model,url:function(){return"/v2/ump/luckymoney/list.json?kdt_id=1&buyer_id="+window._global.buyer_id},parse:function(t){var e=(t||{}).data||{},i=e.list||[];return this.total=parseInt(e.total)||this.total||i.length,i}})}),define("text!wap/trade/lucky_money/templates/lucky_item.html",[],function(){return'<a class="block-link luckymoney-state-<%= is_used %> <%= is_expired ? \'luckymoney-state-expired\' : \'\' %>" href="<%= homepage_url %>">\n    <div class="luckymoney-value">\n        <% if(is_used == 1) { %>\n        <span>已使用</span>\n        <% } else if(is_used == 2) { %>\n        <span>占用中</span>\n        <% } else if(is_expired) { %>\n        <span>已过期</span>\n        <% } else if(is_used == 0) {%>\n        <span>未使用</span>\n        <% }%>\n        <div class="price">\n            <i><%= discount_fee %></i>元\n        </div>\n    </div>\n    <div class="luckymoney-detail">\n        <h3><%= team_name %>红包</h3>\n        <p><%= name %></p>\n        <p>有效期 <%= start_time %> 至 <%= end_time %></p>\n    </div>\n</a>\n'}),define("wap/trade/lucky_money/views/lucky_item",["text!wap/trade/lucky_money/templates/lucky_item.html"],function(t){return Backbone.View.extend({tagName:"div",className:"block-item block-lucky-item animated",template:_.template(t),render:function(){var t=this.model.toJSON(),e=this.template(t);return this.$el.html(e),this}})}),define("text!wap/trade/lucky_money/templates/empty_list.html",[],function(){return'<div class="empty-list" style="margin-top:30px;" class="">\n    <!-- 文本 -->\n    <div>\n        <h4>你还没有领过红包</h4>\n        <p class="font-size-12">总有惊喜在转角</p>\n    </div>\n    <!-- 自定义html，和上面的可以并存 -->\n    <a href="<%= homepage %>" class="tag tag-big tag-red js-goto-homepage" style="padding:8px 20px;">去店铺看看</a>\n</div>\n'}),require(["bower_components/pop/popup","bower_components/pop/popout_box","bower_components/youzanjsbridge/api","bower_components/login/main","bower_components/waterfall/waterfall","wap/trade/lucky_money/collections/lucky_list","wap/trade/lucky_money/views/lucky_item","text!wap/trade/lucky_money/templates/empty_list.html","zenjs/util/args"],function(t,e,i,n,o,s,r,a,c){var h=_.template(a),l=Backbone.View.extend({events:{"click .js-show-login":"onShowLoginClick","click .js-goto-homepage":"onAppBackClick"},initialize:function(){return window._global.need_ajax_login?!1:void this.initWaterFall()},onShowLoginClick:function(t){t.preventDefault(),this.showLoginModal()},showLoginModal:function(){var t=this,i=new e({contentViewClass:n,contentViewOptions:{afterLogin:function(e){t.updateBuyerData(e.data),i.hide(),t.initWaterFall(),t.$(".js-login-container").remove()}}}).render().show()},updateBuyerData:function(t){var e=window._global;e.buyer=t,e.buyer_id=t.id},initWaterFall:function(){var t=$("#lucky-list-container").removeClass("hide"),e=window._global.kdt_id,i="";i=e>0&&"yzapp"!==c.get("f_platform")?window._global.url.wap+"/showcase/homepage?kdt_id="+e:"https://maijia.koudaitong.com",new o({el:t,checkSize:!1,perPage:20,itemView:r,collection:new s([]),finishedText:"已经没有更多红包了！",itemOptions:{},emptyHTML:h({homepage:"youzanmars"===_global.platform?"javascript:;":i})}).fetchRender()},onAppBackClick:function(t){return"youzanmars"===_global.platform?(t.preventDefault(),t.stopPropagation(),i.doAction({action:"goHome"}),!1):void 0}});new l({el:$("body")})}),define("main",function(){});